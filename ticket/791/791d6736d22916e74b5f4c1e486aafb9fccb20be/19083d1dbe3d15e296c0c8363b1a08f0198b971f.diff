diff --git a/include/wx/msw/setup0.h b/include/wx/msw/setup0.h
index 9ac46699d6..02427c4ca0 100644
--- a/include/wx/msw/setup0.h
+++ b/include/wx/msw/setup0.h
@@ -794,7 +794,7 @@
 
 // notice that we can't use wxCHECK_VISUALC_VERSION() here as this file is
 // included from wx/platform.h before wxCHECK_VISUALC_VERSION() is defined
-#ifdef _MSC_VER
+#if defined(_MSC_VER) || defined(__MINGW64_TOOLCHAIN__)
 #   define wxUSE_GRAPHICS_CONTEXT 1
 #else
     // Disable support for other Windows compilers, enable it if your compiler
diff --git a/include/wx/platform.h b/include/wx/platform.h
index e7913cfab6..a41ae1a000 100644
--- a/include/wx/platform.h
+++ b/include/wx/platform.h
@@ -137,6 +137,29 @@
 
 #include "wx/compiler.h"
 
+/*
+    Note that wx/msw/gccpriv.h must be included after defining UNICODE and
+    _UNICODE macros as it includes _mingw.h which relies on them being set.
+ */
+#if ( ( ( defined( __GNUWIN32__ ) || defined( __MINGW32__ ) ) && \
+      ( defined( _UNICODE ) || defined( UNICODE ) ) ) || \
+    ( defined( __CYGWIN__ ) && defined( __WINDOWS__ ) ) ) && \
+    !defined(__WXMOTIF__) && \
+    !defined(__WXX11__)
+#    undef UNICODE
+#    define UNICODE
+#    undef wxUSE_UNICODE
+#    define wxUSE_UNICODE 1
+#    include "wx/msw/gccpriv.h"
+#else
+#    undef wxCHECK_W32API_VERSION
+#    define wxCHECK_W32API_VERSION(maj, min) (0)
+#    undef wxCHECK_MINGW32_VERSION
+#    define wxCHECK_MINGW32_VERSION( major, minor ) (0)
+#    define wxDECL_FOR_MINGW32_ALWAYS(rettype, func, params)
+#    define wxDECL_FOR_STRICT_MINGW32(rettype, func, params)
+#endif
+
 /*
    Include wx/setup.h for the Unix platform defines generated by configure and
    the library compilation options
@@ -356,24 +379,6 @@
 #define wxNEEDS_CHARPP
 #endif
 
-/*
-    Note that wx/msw/gccpriv.h must be included after defining UNICODE and
-    _UNICODE macros as it includes _mingw.h which relies on them being set.
- */
-#if ( defined( __GNUWIN32__ ) || defined( __MINGW32__ ) || \
-    ( defined( __CYGWIN__ ) && defined( __WINDOWS__ ) ) ) && \
-    !defined(__WXMOTIF__) && \
-    !defined(__WXX11__)
-#    include "wx/msw/gccpriv.h"
-#else
-#    undef wxCHECK_W32API_VERSION
-#    define wxCHECK_W32API_VERSION(maj, min) (0)
-#    undef wxCHECK_MINGW32_VERSION
-#    define wxCHECK_MINGW32_VERSION( major, minor ) (0)
-#    define wxDECL_FOR_MINGW32_ALWAYS(rettype, func, params)
-#    define wxDECL_FOR_STRICT_MINGW32(rettype, func, params)
-#endif
-
 
 /*
     Handle Darwin gcc universal compilation.  Don't do this in an Apple-
