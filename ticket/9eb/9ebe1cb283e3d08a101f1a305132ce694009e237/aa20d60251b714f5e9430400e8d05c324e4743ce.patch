Index: contrib/samples/animate/anitest.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/contrib/samples/animate/anitest.cpp,v
retrieving revision 1.7
diff -bu2 -r1.7 contrib/samples/animate/anitest.cpp
--- contrib/samples/animate/anitest.cpp
+++ contrib/samples/animate/anitest.cpp
@@ -155,5 +155,5 @@
 {
     wxFileDialog dialog(this, _T("Please choose an animated GIF"),
-        wxEmptyString, wxEmptyString, wxT("*.gif"), wxOPEN);
+        wxEmptyString, wxEmptyString, wxT("*.gif"), wxFD_OPEN);
     if (dialog.ShowModal() == wxID_OK)
     {
Index: contrib/samples/stc/edit.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/contrib/samples/stc/edit.cpp,v
retrieving revision 1.11
diff -bu2 -r1.11 contrib/samples/stc/edit.cpp
--- contrib/samples/stc/edit.cpp
+++ contrib/samples/stc/edit.cpp
@@ -509,5 +509,5 @@
     if (!m_filename) {
         wxFileDialog dlg (this, _T("Open file"), wxEmptyString, wxEmptyString,
-                          _T("Any file (*)|*"), wxOPEN | wxFILE_MUST_EXIST | wxCHANGE_DIR);
+                          _T("Any file (*)|*"), wxFD_OPEN | wxFD_FILE_MUST_EXIST | wxFD_CHANGE_DIR);
         if (dlg.ShowModal() != wxID_OK) return false;
         m_filename = dlg.GetPath();
@@ -558,5 +558,5 @@
     if (!m_filename) {
         wxFileDialog dlg (this, _T("Save file"), wxEmptyString, wxEmptyString, _T("Any file (*)|*"),
-                          wxSAVE | wxOVERWRITE_PROMPT);
+                          wxFD_SAVE | wxFD_OVERWRITE_PROMPT);
         if (dlg.ShowModal() != wxID_OK) return false;
         m_filename = dlg.GetPath();
Index: contrib/samples/stc/stctest.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/contrib/samples/stc/stctest.cpp,v
retrieving revision 1.20
diff -bu2 -r1.20 contrib/samples/stc/stctest.cpp
--- contrib/samples/stc/stctest.cpp
+++ contrib/samples/stc/stctest.cpp
@@ -353,5 +353,5 @@
     wxString fname;
     wxFileDialog dlg (this, _T("Open file"), wxEmptyString, wxEmptyString, _T("Any file (*)|*"),
-                      wxOPEN | wxFILE_MUST_EXIST | wxCHANGE_DIR);
+                      wxFD_OPEN | wxFD_FILE_MUST_EXIST | wxFD_CHANGE_DIR);
     if (dlg.ShowModal() != wxID_OK) return;
     fname = dlg.GetPath ();
@@ -374,5 +374,5 @@
 #if wxUSE_FILEDLG
     wxString filename = wxEmptyString;
-    wxFileDialog dlg (this, _T("Save file"), wxEmptyString, wxEmptyString, _T("Any file (*)|*"), wxSAVE|wxOVERWRITE_PROMPT);
+    wxFileDialog dlg (this, _T("Save file"), wxEmptyString, wxEmptyString, _T("Any file (*)|*"), wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
     if (dlg.ShowModal() != wxID_OK) return;
     filename = dlg.GetPath();
Index: contrib/samples/svg/svgtest.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/contrib/samples/svg/svgtest.cpp,v
retrieving revision 1.11
diff -bu2 -r1.11 contrib/samples/svg/svgtest.cpp
--- contrib/samples/svg/svgtest.cpp
+++ contrib/samples/svg/svgtest.cpp
@@ -351,5 +351,5 @@
     wxFileDialog dialog(this, wxT("Save Picture as"), wxEmptyString, pChild->GetTitle(),
         wxT("SVG vector picture files (*.svg)|*.svg"),
-        wxSAVE|wxOVERWRITE_PROMPT);
+        wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
 
     if (dialog.ShowModal() == wxID_OK)
Index: contrib/utils/convertrc/convert.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/contrib/utils/convertrc/convert.cpp,v
retrieving revision 1.10
diff -bu2 -r1.10 contrib/utils/convertrc/convert.cpp
--- contrib/utils/convertrc/convert.cpp
+++ contrib/utils/convertrc/convert.cpp
@@ -127,5 +127,5 @@
     wxFileDialog filed(this);
     filed.SetWildcard(_T("*.rc"));
-    filed.SetStyle(wxOPEN);
+    filed.SetStyle(wxFD_OPEN);
 
     if (filed.ShowModal()!=wxID_OK)
@@ -134,5 +134,5 @@
     wxFileDialog wxrfile(this,_T("Enter Desired WXR file name"));
     wxrfile.SetWildcard(_T("*.wxr"));
-    wxrfile.SetStyle(wxOPEN);
+    wxrfile.SetStyle(wxFD_OPEN);
     wxrfile.SetFilename(_T("resource.wxr"));
 
@@ -156,5 +156,5 @@
     wxFileDialog xmlfile(this,_T("Enter Desired XML file name"));
     xmlfile.SetWildcard(_T("*.xml"));
-    xmlfile.SetStyle(wxOPEN);
+    xmlfile.SetStyle(wxFD_OPEN);
     xmlfile.SetFilename(_T("resource.xml"));
 
@@ -177,5 +177,5 @@
     wxFileDialog xmlfile(this,_T("Enter Desired XML file name"));
     xmlfile.SetWildcard(_T("*.xml"));
-    xmlfile.SetStyle(wxOPEN);
+    xmlfile.SetStyle(wxFD_OPEN);
     xmlfile.SetFilename(_T("resource.xml"));
 
Index: demos/life/life.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/demos/life/life.cpp,v
retrieving revision 1.43
diff -bu2 -r1.43 demos/life/life.cpp
--- demos/life/life.cpp
+++ demos/life/life.cpp
@@ -457,5 +457,5 @@
                          wxEmptyString,
                          _("Life patterns (*.lif)|*.lif|All files (*.*)|*.*"),
-                         wxOPEN | wxFILE_MUST_EXIST);
+                         wxFD_OPEN | wxFD_FILE_MUST_EXIST);
 
     if (filedlg.ShowModal() == wxID_OK)
Index: docs/latex/wx/dirdlg.tex
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/docs/latex/wx/dirdlg.tex,v
retrieving revision 1.10
diff -bu2 -r1.10 docs/latex/wx/dirdlg.tex
--- docs/latex/wx/dirdlg.tex
+++ docs/latex/wx/dirdlg.tex
@@ -17,12 +17,11 @@
 
 \begin{twocollist}\itemsep=0pt
-\twocolitem{\windowstyle{wxDD\_DEFAULT\_STYLE}}{Equivalent to a combination of wxDEFAULT\_DIALOG\_STYLE, wxDD\_NEW\_DIR\_BUTTON and wxRESIZE\_BORDER (the last one is not used under wxWinCE).}
-\twocolitem{\windowstyle{wxDD\_NEW\_DIR\_BUTTON}}{Add "Create new
-directory" button and allow directory names to be editable.  On
-Windows the new directory button is only available with recent
-versions of the common dialogs.}
+\twocolitem{\windowstyle{wxDD\_DEFAULT\_STYLE}}{Equivalent to a combination of wxDEFAULT\_DIALOG\_STYLE and wxRESIZE\_BORDER (the last one is not used under wxWinCE).}
+\twocolitem{\windowstyle{wxDD\_DIR_MUST_EXIST}}{The dialog will allow the user to choose only an existing folder. When this style is not given, a "Create new directory" button is added to the dialog (on Windows) or some other way is provided to the user to type the name of a new folder.}
 \twocolitem{\windowstyle{wxDD\_CHANGE\_DIR}}{Change the current working directory to the directory chosen by the user.}
 \end{twocollist}
 
+{\bf NB:} on Windows the new directory button is only available with recent versions of the common dialogs.
+
 See also \helpref{Generic window styles}{windowstyles}.
 
Index: docs/latex/wx/filedlg.tex
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/docs/latex/wx/filedlg.tex,v
retrieving revision 1.22
diff -bu2 -r1.22 docs/latex/wx/filedlg.tex
--- docs/latex/wx/filedlg.tex
+++ docs/latex/wx/filedlg.tex
@@ -14,4 +14,24 @@
 <wx/filedlg.h>
 
+\wxheading{Window styles}
+
+\begin{twocollist}\itemsep=0pt
+\twocolitem{\windowstyle{wxFD\_DEFAULT\_STYLE}}{Equivalent to wxFD_OPEN.}
+\twocolitem{\windowstyle{wxFD\_OPEN}}{This is an open dialog; usually this means that the default button's label of the dialog is "Open". Cannot be combined with wxFD\_SAVE.}
+\twocolitem{\windowstyle{wxFD\_SAVE}}{This is a save dialog; usually this means that the default button's label of the dialog is "Save". Cannot be combined with wxFD\_OPEN.}
+\twocolitem{{\windowstyle wxFD\_OVERWRITE\_PROMPT}}{For save dialog only: prompt for a confirmation if a file will be overwritten.}
+\twocolitem{{\windowstyle wxFD\_FILE\_MUST\_EXIST}}{For open dialog only: the user may only select files that actually exist.}
+\twocolitem{{\windowstyle wxFD_MULTIPLE}}{For open dialog only: allows selecting multiple files.}
+\twocolitem{{\windowstyle wxFD_CHANGE\_DIR}}{Change the current working directory to the directory where the file(s) chosen by the user are.}
+\end{twocollist}
+
+{\bf NB:} Previous versions of wxWidgets used {\tt wxFD_CHANGE\_DIR} by default
+under MS Windows which allowed the program to simply remember the last
+directory where user selected the files to open/save. This (desired)
+functionality must be implemented in the program itself now (manually remember
+the last path used and pass it to the dialog the next time it is called) or
+by using this flag.
+
+
 \wxheading{See also}
 
@@ -26,7 +46,5 @@
 no default filename will be supplied. The wildcard determines what files
 are displayed in the file selector, and file extension supplies a type
-extension for the required filename. Flags may be a combination of wxOPEN,
-wxSAVE, wxOVERWRITE\_PROMPT, wxHIDE\_READONLY, wxFILE\_MUST\_EXIST,
-wxMULTIPLE, wxCHANGE\_DIR or 0.
+extension for the required filename.
 
 Both the X and Windows versions implement a wildcard filter. Typing a
@@ -53,5 +71,5 @@
 \func{}{wxFileDialog}{\param{wxWindow* }{parent}, \param{const wxString\& }{message = "Choose a file"},\rtfsp
 \param{const wxString\& }{defaultDir = ""}, \param{const wxString\& }{defaultFile = ``"},\rtfsp
-\param{const wxString\& }{wildcard = ``*.*"}, \param{long }{style = 0}, \param{const wxPoint\& }{pos = wxDefaultPosition}}
+\param{const wxString\& }{wildcard = ``*.*"}, \param{long }{style = wxFD\_DEFAULT\_STYLE}, \param{const wxPoint\& }{pos = wxDefaultPosition}, \param{const wxSize\& }{sz = wxDefaultSize}, \param{const wxString\& }{name = "filedlg"}}
 
 Constructor. Use \helpref{wxFileDialog::ShowModal}{wxfiledialogshowmodal} to show the dialog.
@@ -72,26 +90,12 @@
 wildcards; see the Remarks section above.}
 
-\docparam{style}{A dialog style. A bitlist of:
-
-\twocolwidtha{5cm}
-\begin{twocollist}
-\twocolitem{{\bf wxOPEN}}{This is an open dialog.}
-\twocolitem{{\bf wxSAVE}}{This is a save dialog.}
-\twocolitem{{\bf wxOVERWRITE\_PROMPT}}{For save dialog only: prompt for a confirmation if a file will be overwritten.}
-\twocolitem{{\bf wxHIDE\_READONLY}}{Do not display the checkbox to toggle display of read-only files. Deprecated in 2.6; the checkbox is never shown.}
-\twocolitem{{\bf wxFILE\_MUST\_EXIST}}{The user may only select files that actually exist.}
-\twocolitem{{\bf wxMULTIPLE}}{For open dialog only: allows selecting multiple files.}
-\twocolitem{{\bf wxCHANGE\_DIR}}{Change the current working directory to the directory where the file(s) chosen by the user are.}
-\end{twocollist}%
-}
+\docparam{style}{A dialog style. See wxFD_* styles for more info.}
 
 \docparam{pos}{Dialog position. Not implemented.}
 
-{\bf NB:} Previous versions of wxWidgets used {\tt wxCHANGE\_DIR} by default
-under MS Windows which allowed the program to simply remember the last
-directory where user selected the files to open/save. This (desired)
-functionality must be implemented in the program itself now (manually remember
-the last path used and pass it to the dialog the next time it is called) or
-by using this flag.
+\docparam{size}{Dialog size. Not implemented.}
+
+\docparam{name}{Dialog name. Not implemented.}
+
 
 \membersection{wxFileDialog::\destruct{wxFileDialog}}\label{wxfiledialogdtor}
@@ -154,10 +158,4 @@
 use \helpref{GetPath}{wxfiledialoggetpath} for the others.
 
-\membersection{wxFileDialog::GetStyle}\label{wxfiledialoggetstyle}
-
-\constfunc{long}{GetStyle}{\void}
-
-Returns the dialog style.
-
 \membersection{wxFileDialog::GetWildcard}\label{wxfiledialoggetwildcard}
 
@@ -196,10 +194,4 @@
 Sets the path (the combined directory and filename that will be returned when the dialog is dismissed).
 
-\membersection{wxFileDialog::SetStyle}\label{wxfiledialogsetstyle}
-
-\func{void}{SetStyle}{\param{long }{style}}
-
-Sets the dialog style. See \helpref{wxFileDialog::wxFileDialog}{wxfiledialogctor} for details.
-
 \membersection{wxFileDialog::SetWildcard}\label{wxfiledialogsetwildcard}
 
Index: include/wx/defs.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/defs.h,v
retrieving revision 1.539
diff -bu2 -r1.539 include/wx/defs.h
--- include/wx/defs.h
+++ include/wx/defs.h
@@ -1707,11 +1707,4 @@
 #define wxPD_CAN_SKIP           0x0080
 
-/*
- * wxDirDialog styles
- */
-
-#define wxDD_NEW_DIR_BUTTON     0x0080
-#define wxDD_CHANGE_DIR         0x0100
-
 
 /*
Index: include/wx/dirdlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/dirdlg.h,v
retrieving revision 1.46
diff -bu2 -r1.46 include/wx/dirdlg.h
--- include/wx/dirdlg.h
+++ include/wx/dirdlg.h
@@ -25,11 +25,11 @@
 extern WXDLLEXPORT_DATA(const wxChar) wxDirSelectorPromptStr[];
 
+#define wxDD_DIR_MUST_EXIST     0x0080
+#define wxDD_CHANGE_DIR         0x0100
 
 #ifdef __WXWINCE__
-    #define wxDD_DEFAULT_STYLE \
-        (wxDEFAULT_DIALOG_STYLE | wxDD_NEW_DIR_BUTTON)
+    #define wxDD_DEFAULT_STYLE      wxDEFAULT_DIALOG_STYLE
 #else
-    #define wxDD_DEFAULT_STYLE \
-        (wxDEFAULT_DIALOG_STYLE | wxRESIZE_BORDER | wxDD_NEW_DIR_BUTTON)
+    #define wxDD_DEFAULT_STYLE      (wxDEFAULT_DIALOG_STYLE|wxRESIZE_BORDER)
 #endif
 
@@ -86,48 +86,25 @@
 // Universal and non-port related switches with need for generic implementation
 #if defined(__WXUNIVERSAL__)
-
     #include "wx/generic/dirdlgg.h"
     #define wxDirDialog wxGenericDirDialog
-
 #elif defined(__WXMSW__) && (defined(__SALFORDC__)    || \
                              !wxUSE_OLE               || \
                              (defined (__GNUWIN32__) && !wxUSE_NORLANDER_HEADERS))
-
     #include "wx/generic/dirdlgg.h"
     #define wxDirDialog wxGenericDirDialog
-
-// MS PocketPC or MS Smartphone
 #elif defined(__WXMSW__) && defined(__WXWINCE__) && !defined(__HANDHELDPC__)
-
-    #include "wx/generic/dirdlgg.h"
+    #include "wx/generic/dirdlgg.h"     // MS PocketPC or MS Smartphone
     #define wxDirDialog wxGenericDirDialog
-
-// Native MSW
 #elif defined(__WXMSW__)
-
-    #include "wx/msw/dirdlg.h"
-
-// Native GTK for gtk2.x and generic for gtk1.x
+    #include "wx/msw/dirdlg.h"  // Native MSW
+#elif defined(__WXGTK24__)
+    #include "wx/gtk/dirdlg.h"  // Native GTK for gtk2.4
 #elif defined(__WXGTK__)
-
-#if defined( __WXGTK20__ )
-    #include "wx/gtk/dirdlg.h"
-    #define wxDirDialog wxDirDialogGTK
-#else
     #include "wx/generic/dirdlgg.h"
     #define wxDirDialog wxGenericDirDialog
-#endif
-
-// Native Mac
 #elif defined(__WXMAC__)
-
-    #include "wx/mac/dirdlg.h"
-
-// Native Cocoa
+    #include "wx/mac/dirdlg.h"      // Native Mac
 #elif defined(__WXCOCOA__)
-
-    #include "wx/cocoa/dirdlg.h"
-
-// Other ports use generic implementation
+    #include "wx/cocoa/dirdlg.h"    // Native Cocoa
 #elif defined(__WXMOTIF__) || \
       defined(__WXX11__)   || \
@@ -135,8 +112,6 @@
       defined(__WXCOCOA__) || \
       defined(__WXPM__)
-
-    #include "wx/generic/dirdlgg.h"
+    #include "wx/generic/dirdlgg.h"     // Other ports use generic implementation
     #define wxDirDialog wxGenericDirDialog
-
 #endif
 
Index: include/wx/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/filedlg.h,v
retrieving revision 1.44
diff -bu2 -r1.44 include/wx/filedlg.h
--- include/wx/filedlg.h
+++ include/wx/filedlg.h
@@ -24,4 +24,5 @@
 //----------------------------------------------------------------------------
 
+#if WXWIN_COMPATIBILITY_2_6
 enum
 {
@@ -36,5 +37,19 @@
     wxCHANGE_DIR        = 0x0040
 };
+#endif
 
+enum
+{
+    wxFD_OPEN              = 0x0001,
+    wxFD_SAVE              = 0x0002,
+    wxFD_OVERWRITE_PROMPT  = 0x0004,
+    wxFD_FILE_MUST_EXIST   = 0x0010,
+    wxFD_MULTIPLE          = 0x0020,
+    wxFD_CHANGE_DIR        = 0x0040
+};
+
+#define wxFD_DEFAULT_STYLE      wxFD_OPEN
+
+extern WXDLLEXPORT_DATA(const wxChar) wxFileDialogNameStr[];
 extern WXDLLEXPORT_DATA(const wxChar) wxFileSelectorPromptStr[];
 extern WXDLLEXPORT_DATA(const wxChar) wxFileSelectorDefaultWildcardStr[];
@@ -54,9 +69,11 @@
                      const wxString& defaultFile = wxEmptyString,
                      const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                     long style = 0,
-                     const wxPoint& pos = wxDefaultPosition) : wxDialog()
+                     long style = wxFD_DEFAULT_STYLE,
+                     const wxPoint& pos = wxDefaultPosition,
+                     const wxSize& sz = wxDefaultSize,
+                     const wxString& name = wxFileDialogNameStr)
     {
         Init();
-        Create(parent, message, defaultDir, defaultFile, wildCard, style, pos);
+        Create(parent, message, defaultDir, defaultFile, wildCard, style, pos, sz, name);
     }
 
@@ -66,6 +83,8 @@
                 const wxString& defaultFile = wxEmptyString,
                 const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                long style = 0,
-                const wxPoint& pos = wxDefaultPosition);
+                long style = wxFD_DEFAULT_STYLE,
+                const wxPoint& pos = wxDefaultPosition,
+                const wxSize& sz = wxDefaultSize,
+                const wxString& name = wxFileDialogNameStr);
 
     virtual void SetMessage(const wxString& message) { m_message = message; }
@@ -74,5 +93,4 @@
     virtual void SetFilename(const wxString& name) { m_fileName = name; }
     virtual void SetWildcard(const wxString& wildCard) { m_wildCard = wildCard; }
-    virtual void SetStyle(long style) { m_dialogStyle = style; }
     virtual void SetFilterIndex(int filterIndex) { m_filterIndex = filterIndex; }
 
@@ -84,5 +102,4 @@
     virtual void GetFilenames(wxArrayString& files) const { files.Empty(); files.Add(m_fileName); }
     virtual wxString GetWildcard() const { return m_wildCard; }
-    virtual long GetStyle() const { return m_dialogStyle; }
     virtual int GetFilterIndex() const { return m_filterIndex; }
 
@@ -109,5 +126,4 @@
 protected:
     wxString      m_message;
-    long          m_dialogStyle;
     wxString      m_dir;
     wxString      m_path;       // Full path
@@ -169,6 +185,8 @@
 #elif defined(__WXMOTIF__)
 #include "wx/motif/filedlg.h"
+#elif defined(__WXGTK24__)
+#include "wx/gtk/filedlg.h"     // GTK+ > 2.4 has native version
 #elif defined(__WXGTK20__)
-#include "wx/gtk/filedlg.h"
+#include "wx/generic/filedlgg.h"
 #elif defined(__WXGTK__)
 #include "wx/gtk1/filedlg.h"
Index: include/wx/cocoa/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/cocoa/filedlg.h,v
retrieving revision 1.3
diff -bu2 -r1.3 include/wx/cocoa/filedlg.h
--- include/wx/cocoa/filedlg.h
+++ include/wx/cocoa/filedlg.h
@@ -30,6 +30,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
     ~wxFileDialog();
 
Index: include/wx/generic/dirdlgg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/generic/dirdlgg.h,v
retrieving revision 1.33
diff -bu2 -r1.33 include/wx/generic/dirdlgg.h
--- include/wx/generic/dirdlgg.h
+++ include/wx/generic/dirdlgg.h
@@ -26,9 +26,7 @@
 #ifndef wxDD_DEFAULT_STYLE
 #ifdef __WXWINCE__
-    #define wxDD_DEFAULT_STYLE \
-        (wxDEFAULT_DIALOG_STYLE | wxDD_NEW_DIR_BUTTON)
+    #define wxDD_DEFAULT_STYLE      wxDEFAULT_DIALOG_STYLE
 #else
-    #define wxDD_DEFAULT_STYLE \
-        (wxDEFAULT_DIALOG_STYLE | wxRESIZE_BORDER | wxDD_NEW_DIR_BUTTON)
+    #define wxDD_DEFAULT_STYLE      (wxDEFAULT_DIALOG_STYLE|wxRESIZE_BORDER)
 #endif
 #endif
Index: include/wx/generic/filedlgg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/generic/filedlgg.h,v
retrieving revision 1.42
diff -bu2 -r1.42 include/wx/generic/filedlgg.h
--- include/wx/generic/filedlgg.h
+++ include/wx/generic/filedlgg.h
@@ -51,6 +51,8 @@
                         const wxString& defaultFile = wxEmptyString,
                         const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                        long style = 0,
+                        long style = wxFD_DEFAULT_STYLE,
                         const wxPoint& pos = wxDefaultPosition,
+                        const wxSize& sz = wxDefaultSize,
+                        const wxString& name = wxFileDialogNameStr,
                         bool bypassGenericImpl = false );
 
@@ -60,6 +62,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
+                 long style = wxFD_DEFAULT_STYLE,
                  const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr,
                  bool bypassGenericImpl = false );
 
Index: include/wx/gtk/dirdlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/gtk/dirdlg.h,v
retrieving revision 1.5
diff -bu2 -r1.5 include/wx/gtk/dirdlg.h
--- include/wx/gtk/dirdlg.h
+++ include/wx/gtk/dirdlg.h
@@ -1,5 +1,5 @@
 /////////////////////////////////////////////////////////////////////////////
 // Name:        dirdlg.h
-// Purpose:     wxDirDialogGTK
+// Purpose:     wxDirDialog
 // Author:      Francesco Montorsi
 // Id:          $Id: dirdlg.h,v 1.5 2006/05/06 20:09:58 VZ Exp $
@@ -14,13 +14,13 @@
 
 //-------------------------------------------------------------------------
-// wxDirDialogGTK
+// wxDirDialog
 //-------------------------------------------------------------------------
 
-class WXDLLIMPEXP_CORE wxDirDialogGTK : public wxGenericDirDialog
+class WXDLLIMPEXP_CORE wxDirDialog : public wxGenericDirDialog
 {
 public:
-    wxDirDialogGTK() { }
+    wxDirDialog() { }
 
-    wxDirDialogGTK(wxWindow *parent,
+    wxDirDialog(wxWindow *parent,
                 const wxString& message = wxDirSelectorPromptStr,
                 const wxString& defaultPath = wxEmptyString,
@@ -30,5 +30,5 @@
                 const wxString& name = wxDirDialogNameStr);
 
-    virtual ~wxDirDialogGTK();
+    virtual ~wxDirDialog();
 
 
@@ -54,5 +54,5 @@
 
 private:
-    DECLARE_DYNAMIC_CLASS(wxDirDialogGTK)
+    DECLARE_DYNAMIC_CLASS(wxDirDialog)
     DECLARE_EVENT_TABLE()
     void OnFakeOk( wxCommandEvent &event );
Index: include/wx/gtk/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/gtk/filedlg.h,v
retrieving revision 1.30
diff -bu2 -r1.30 include/wx/gtk/filedlg.h
--- include/wx/gtk/filedlg.h
+++ include/wx/gtk/filedlg.h
@@ -27,6 +27,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
 
     virtual ~wxFileDialog();
Index: include/wx/gtk1/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/gtk1/filedlg.h,v
retrieving revision 1.30
diff -bu2 -r1.30 include/wx/gtk1/filedlg.h
--- include/wx/gtk1/filedlg.h
+++ include/wx/gtk1/filedlg.h
@@ -27,6 +27,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
 
     virtual ~wxFileDialog();
Index: include/wx/motif/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/motif/filedlg.h,v
retrieving revision 1.12
diff -bu2 -r1.12 include/wx/motif/filedlg.h
--- include/wx/motif/filedlg.h
+++ include/wx/motif/filedlg.h
@@ -32,6 +32,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
     
     virtual int ShowModal();
Index: include/wx/msw/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/msw/filedlg.h,v
retrieving revision 1.22
diff -bu2 -r1.22 include/wx/msw/filedlg.h
--- include/wx/msw/filedlg.h
+++ include/wx/msw/filedlg.h
@@ -25,6 +25,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
 
     virtual void SetPath(const wxString& path);
Index: include/wx/os2/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/os2/filedlg.h,v
retrieving revision 1.11
diff -bu2 -r1.11 include/wx/os2/filedlg.h
--- include/wx/os2/filedlg.h
+++ include/wx/os2/filedlg.h
@@ -26,6 +26,8 @@
                  ,const wxString& rsDefaultFile = wxEmptyString
                  ,const wxString& rsWildCard = wxFileSelectorDefaultWildcardStr
-                 ,long            lStyle = 0
-                 ,const wxPoint&  rPos = wxDefaultPosition
+                 ,long            lStyle = wxFD_DEFAULT_STYLE
+                 ,const wxPoint&  rPos = wxDefaultPosition,
+                  const wxSize& sz = wxDefaultSize,
+                  const wxString& name = wxFileDialogNameStr
                 );
 
Index: include/wx/palmos/filedlg.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/palmos/filedlg.h,v
retrieving revision 1.3
diff -bu2 -r1.3 include/wx/palmos/filedlg.h
--- include/wx/palmos/filedlg.h
+++ include/wx/palmos/filedlg.h
@@ -25,6 +25,8 @@
                  const wxString& defaultFile = wxEmptyString,
                  const wxString& wildCard = wxFileSelectorDefaultWildcardStr,
-                 long style = 0,
-                 const wxPoint& pos = wxDefaultPosition);
+                 long style = wxFD_DEFAULT_STYLE,
+                 const wxPoint& pos = wxDefaultPosition,
+                 const wxSize& sz = wxDefaultSize,
+                 const wxString& name = wxFileDialogNameStr);
 
     virtual void SetPath(const wxString& path);
Index: samples/combo/combo.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/combo/combo.cpp,v
retrieving revision 1.2
diff -bu2 -r1.2 samples/combo/combo.cpp
--- samples/combo/combo.cpp
+++ samples/combo/combo.cpp
@@ -598,5 +598,5 @@
                          GetValue(),
                          wxT("All files (*.*)|*.*"),
-                         wxOPEN);
+                         wxFD_OPEN);
 
         if ( dlg.ShowModal() == wxID_OK )
Index: samples/db/dbtest.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/db/dbtest.cpp,v
retrieving revision 1.63
diff -bu2 -r1.63 samples/db/dbtest.cpp
--- samples/db/dbtest.cpp
+++ samples/db/dbtest.cpp
@@ -1713,5 +1713,5 @@
 void CeditorDlg::OnSelectPict()
 {
-    wxFileDialog dlg(this, wxT("Choose an image file less than 60K"), wxEmptyString, wxEmptyString, wxT("JPEG files (*.jpg)|*.jpg|GIF files (*.gif)|*.gif|BMP files (*.bmp)|*.bmp|All Files (*.*)|*.*"), wxOPEN);
+    wxFileDialog dlg(this, wxT("Choose an image file less than 60K"), wxEmptyString, wxEmptyString, wxT("JPEG files (*.jpg)|*.jpg|GIF files (*.gif)|*.gif|BMP files (*.bmp)|*.bmp|All Files (*.*)|*.*"), wxFD_OPEN);
 
     if (dlg.ShowModal() == wxID_OK)
Index: samples/dialogs/dialogs.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/dialogs/dialogs.cpp,v
retrieving revision 1.146
diff -bu2 -r1.146 samples/dialogs/dialogs.cpp
--- samples/dialogs/dialogs.cpp
+++ samples/dialogs/dialogs.cpp
@@ -730,5 +730,5 @@
                                         wxFileSelectorDefaultWildcardStr
                                     ),
-                                    wxCHANGE_DIR,
+                                    wxFD_OPEN|wxFD_CHANGE_DIR,
                                     this
                                    );
@@ -759,5 +759,5 @@
     wxFileDialog dialog(this, _T("Testing open multiple file dialog"),
                         wxEmptyString, wxEmptyString, wildcards,
-                        wxMULTIPLE);
+                        wxFD_OPEN|wxFD_MULTIPLE);
 
     if (dialog.ShowModal() == wxID_OK)
@@ -792,5 +792,5 @@
                         _T("myletter.doc"),
                         _T("Text files (*.txt)|*.txt|Document files (*.doc)|*.doc"),
-                        wxSAVE|wxOVERWRITE_PROMPT);
+                        wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
 
     dialog.SetFilterIndex(1);
@@ -906,10 +906,10 @@
 void MyFrame::DirChoose(wxCommandEvent& WXUNUSED(event) )
 {
-    DoDirChoose(wxDD_DEFAULT_STYLE & ~wxDD_NEW_DIR_BUTTON);
+    DoDirChoose(wxDD_DEFAULT_STYLE | wxDD_DIR_MUST_EXIST);
 }
 
 void MyFrame::DirChooseNew(wxCommandEvent& WXUNUSED(event) )
 {
-    DoDirChoose(wxDD_DEFAULT_STYLE | wxDD_NEW_DIR_BUTTON);
+    DoDirChoose(wxDD_DEFAULT_STYLE & ~wxDD_DIR_MUST_EXIST);
 }
 #endif // wxUSE_DIRDLG
Index: samples/image/image.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/image/image.cpp,v
retrieving revision 1.109
diff -bu2 -r1.109 samples/image/image.cpp
--- samples/image/image.cpp
+++ samples/image/image.cpp
@@ -173,5 +173,5 @@
                                                 wxT("ICO files (*.ico)|*.ico|")
                                                 wxT("CUR files (*.cur)|*.cur"),
-                                                wxSAVE,
+                                                wxFD_SAVE,
                                                 this);
 
Index: samples/mobile/wxedit/wxedit.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/mobile/wxedit/wxedit.cpp,v
retrieving revision 1.13
diff -bu2 -r1.13 samples/mobile/wxedit/wxedit.cpp
--- samples/mobile/wxedit/wxedit.cpp
+++ samples/mobile/wxedit/wxedit.cpp
@@ -221,5 +221,5 @@
     wxFileDialog dialog( this, _T("Open text"), wxEmptyString, wxEmptyString,
         _T("Text file (*.txt)|*.txt|Any file (*)|*"),
-        wxOPEN|wxFILE_MUST_EXIST );
+        wxFD_OPEN|wxFD_FILE_MUST_EXIST );
     if (dialog.ShowModal() == wxID_OK)
     {
@@ -276,5 +276,5 @@
     wxFileDialog dialog( this, _T("Open text"), wxEmptyString, wxEmptyString,
         _T("Text file (*.txt)|*.txt|Any file (*)|*"),
-        wxSAVE|wxOVERWRITE_PROMPT );
+        wxFD_SAVE|wxFD_OVERWRITE_PROMPT );
     if (dialog.ShowModal() == wxID_OK)
     {
Index: samples/opengl/penguin/penguin.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/opengl/penguin/penguin.cpp,v
retrieving revision 1.14
diff -bu2 -r1.14 samples/opengl/penguin/penguin.cpp
--- samples/opengl/penguin/penguin.cpp
+++ samples/opengl/penguin/penguin.cpp
@@ -109,5 +109,5 @@
         wxT("DXF Drawing (*.dxf)|*.dxf)|All files (*.*)|*.*"),
 #endif
-        wxOPEN);
+        wxFD_OPEN);
     if (!filename.IsEmpty())
     {
Index: samples/richtext/richtext.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/richtext/richtext.cpp,v
retrieving revision 1.9
diff -bu2 -r1.9 samples/richtext/richtext.cpp
--- samples/richtext/richtext.cpp
+++ samples/richtext/richtext.cpp
@@ -722,5 +722,5 @@
         filename,
         filter,
-        wxOPEN);
+        wxFD_OPEN);
 
     if (dialog.ShowModal() == wxID_OK)
@@ -760,5 +760,5 @@
         filename,
         filter,
-        wxSAVE);
+        wxFD_SAVE);
 
     if (dialog.ShowModal() == wxID_OK)
Index: samples/sound/sound.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/samples/sound/sound.cpp,v
retrieving revision 1.15
diff -bu2 -r1.15 samples/sound/sound.cpp
--- samples/sound/sound.cpp
+++ samples/sound/sound.cpp
@@ -985,5 +985,5 @@
     wxFileDialog dlg(this, _T("Choose a sound file"),
                      wxEmptyString, wxEmptyString,
-                     _T("WAV files (*.wav)|*.wav"), wxOPEN|wxCHANGE_DIR);
+                     _T("WAV files (*.wav)|*.wav"), wxFD_OPEN|wxFD_CHANGE_DIR);
     if ( dlg.ShowModal() == wxID_OK )
     {
Index: src/common/datacmn.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/common/datacmn.cpp,v
retrieving revision 1.15
diff -bu2 -r1.15 src/common/datacmn.cpp
--- src/common/datacmn.cpp
+++ src/common/datacmn.cpp
@@ -77,4 +77,5 @@
 extern WXDLLEXPORT_DATA(const wxChar) wxDialogNameStr[] = wxT("dialog");
 extern WXDLLEXPORT_DATA(const wxChar) wxFrameNameStr[] = wxT("frame");
+extern WXDLLEXPORT_DATA(const wxChar) wxFileDialogNameStr[] = wxT("filedlg");
 extern WXDLLEXPORT_DATA(const wxChar) wxGaugeNameStr[] = wxT("gauge");
 extern WXDLLEXPORT_DATA(const wxChar) wxStaticBoxNameStr[] = wxT("groupBox");
Index: src/common/docview.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/common/docview.cpp,v
retrieving revision 1.142
diff -bu2 -r1.142 src/common/docview.cpp
--- src/common/docview.cpp
+++ src/common/docview.cpp
@@ -305,5 +305,5 @@
             docTemplate->GetDefaultExtension(),
             filter,
-            wxSAVE | wxOVERWRITE_PROMPT,
+            wxFD_SAVE | wxFD_OVERWRITE_PROMPT,
             GetDocumentWindow());
 
Index: src/common/dseldlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/common/dseldlg.cpp,v
retrieving revision 1.8
diff -bu2 -r1.8 src/common/dseldlg.cpp
--- src/common/dseldlg.cpp
+++ src/common/dseldlg.cpp
@@ -36,6 +36,4 @@
 // ============================================================================
 
-const wxChar wxDirSelectorPromptStr[] = wxT("Select a directory");
-
 wxString wxDirSelector(const wxString& message,
                        const wxString& defaultPath,
Index: src/common/fldlgcmn.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/common/fldlgcmn.cpp,v
retrieving revision 1.25
diff -bu2 -r1.25 src/common/fldlgcmn.cpp
--- src/common/fldlgcmn.cpp
+++ src/common/fldlgcmn.cpp
@@ -36,5 +36,5 @@
 {
     m_filterIndex =
-    m_dialogStyle = 0;
+    m_windowStyle = 0;
 }
 
@@ -45,5 +45,7 @@
                               const wxString& wildCard,
                               long style,
-                              const wxPoint& WXUNUSED(pos))
+                              const wxPoint& WXUNUSED(pos),
+                              const wxSize& WXUNUSED(sz),
+                              const wxString& WXUNUSED(name))
 {
     m_message = message;
@@ -53,7 +55,18 @@
 
     m_parent = parent;
-    m_dialogStyle = style;
+    m_windowStyle = style;
     m_filterIndex = 0;
 
+#ifdef __WXDEBUG__
+    // check the given styles
+    wxASSERT_MSG(HasFlag(wxFD_OPEN) || HasFlag(wxFD_SAVE), wxT("You must specify one of wxFD_OPEN and wxFD_SAVE styles"));
+    if (HasFlag(wxFD_SAVE))
+        wxASSERT_MSG( !HasFlag(wxFD_OPEN) && !HasFlag(wxFD_MULTIPLE) && !HasFlag(wxFD_FILE_MUST_EXIST),
+                      wxT("wxFileDialog - wxFD_OPEN, wxFD_MULTIPLE or wxFD_FILE_MUST_EXIST used on a save dialog" ) );
+    if (HasFlag(wxFD_OPEN))
+        wxASSERT_MSG( !HasFlag(wxFD_SAVE) && !HasFlag(wxFD_OVERWRITE_PROMPT),
+                      wxT("wxFileDialog - wxFD_SAVE or wxFD_OVERWRITE_PROMPT used on a open dialog" ) );
+#endif
+
     if ( wildCard.empty() || wildCard == wxFileSelectorDefaultWildcardStr )
     {
@@ -271,5 +284,5 @@
 
     return wxFileSelector(prompt, NULL, default_name, ext, wild,
-                          load ? wxOPEN : wxSAVE, parent);
+                          load ? wxFD_OPEN : wxFD_SAVE, parent);
 }
 
Index: src/generic/dirdlgg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/generic/dirdlgg.cpp,v
retrieving revision 1.69
diff -bu2 -r1.69 src/generic/dirdlgg.cpp
--- src/generic/dirdlgg.cpp
+++ src/generic/dirdlgg.cpp
@@ -110,5 +110,5 @@
     dirMenu->Append(ID_GO_HOME, _("Home"));
 
-    if (style & wxDD_NEW_DIR_BUTTON)
+    if (!HasFlag(wxDD_DIR_MUST_EXIST))
     {
         dirMenu->Append(ID_NEW, _("New directory"));
@@ -134,5 +134,5 @@
     // I'm not convinced we need a New button, and we tend to get annoying
     // accidental-editing with label editing enabled.
-    if (style & wxDD_NEW_DIR_BUTTON)
+    if (!HasFlag(wxDD_DIR_MUST_EXIST))
     {
         wxBitmapButton* newButton =
@@ -159,5 +159,5 @@
 
 #ifdef __WXMSW__
-    if (style & wxDD_NEW_DIR_BUTTON)
+    if (!HasFlag(wxDD_DIR_MUST_EXIST))
     {
         // Only under Windows do we need the wxTR_EDIT_LABEL tree control style
Index: src/generic/filedlgg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/generic/filedlgg.cpp,v
retrieving revision 1.157
diff -bu2 -r1.157 src/generic/filedlgg.cpp
--- src/generic/filedlgg.cpp
+++ src/generic/filedlgg.cpp
@@ -48,5 +48,5 @@
 #include "wx/filefn.h"
 #include "wx/file.h"        // for wxS_IXXX constants only
-#include "wx/filedlg.h"     // wxOPEN, wxSAVE...
+#include "wx/filedlg.h"     // wxFD_OPEN, wxFD_SAVE...
 #include "wx/generic/filedlgg.h"
 #include "wx/generic/dirctrlg.h" // for wxFileIconsTable
@@ -976,8 +976,10 @@
                            long  style,
                            const wxPoint& pos,
+                           const wxSize& sz,
+                           const wxString& name,
                            bool  bypassGenericImpl ) : wxFileDialogBase()
 {
     Init();
-    Create( parent, message, defaultDir, defaultFile, wildCard, style, pos, bypassGenericImpl );
+    Create( parent, message, defaultDir, defaultFile, wildCard, style, pos, sz, name, bypassGenericImpl );
 }
 
@@ -989,4 +991,6 @@
                                   long  style,
                                   const wxPoint& pos,
+                                  const wxSize& sz,
+                                  const wxString& name,
                                   bool  bypassGenericImpl )
 {
@@ -994,5 +998,5 @@
 
     if (!wxFileDialogBase::Create(parent, message, defaultDir, defaultFile,
-                                  wildCard, style, pos))
+                                  wildCard, style, pos, sz, name))
     {
         return false;
@@ -1002,6 +1006,6 @@
         return true;
 
-    if (!wxDialog::Create( parent, wxID_ANY, message, pos, wxDefaultSize,
-                           wxDEFAULT_DIALOG_STYLE | wxRESIZE_BORDER
+    if (!wxDialog::Create( parent, wxID_ANY, message, pos, sz,
+                           wxDEFAULT_DIALOG_STYLE | wxRESIZE_BORDER, name
                            ))
     {
@@ -1019,9 +1023,4 @@
     }
 
-    if (m_dialogStyle == 0)
-        m_dialogStyle = wxOPEN;
-    if ((m_dialogStyle & wxMULTIPLE ) && !(m_dialogStyle & wxOPEN))
-        m_dialogStyle |= wxOPEN;
-
     if ((m_dir.empty()) || (m_dir == wxT(".")))
     {
@@ -1104,5 +1103,5 @@
 
     long style2 = ms_lastViewStyle;
-    if ( !(m_dialogStyle & wxMULTIPLE) )
+    if ( !HasFlag(wxFD_MULTIPLE) )
         style2 |= wxLC_SINGLE_SEL;
 
@@ -1398,5 +1397,5 @@
 #endif // __UNIX__
 
-    if (!(m_dialogStyle & wxSAVE))
+    if (!HasFlag(wxFD_SAVE))
     {
         if ((filename.Find(wxT('*')) != wxNOT_FOUND) ||
@@ -1443,5 +1442,5 @@
     //     dialog is not entirely clear to me, why don't we allow saving to a
     //     file without extension as well?
-    if ( !(m_dialogStyle & wxOPEN) || !wxFileExists(filename) )
+    if ( !HasFlag(wxFD_OPEN) || !wxFileExists(filename) )
     {
         filename = AppendExtension(filename, m_filterExtension);
@@ -1449,6 +1448,5 @@
 
     // check that the file [doesn't] exist if necessary
-    if ( (m_dialogStyle & wxSAVE) &&
-            (m_dialogStyle & wxOVERWRITE_PROMPT) &&
+    if ( HasFlag(wxFD_SAVE) && HasFlag(wxFD_OVERWRITE_PROMPT) &&
                 wxFileExists( filename ) )
     {
@@ -1459,6 +1457,5 @@
             return;
     }
-    else if ( (m_dialogStyle & wxOPEN) &&
-                (m_dialogStyle & wxFILE_MUST_EXIST) &&
+    else if ( HasFlag(wxFD_OPEN) && HasFlag(wxFD_FILE_MUST_EXIST) &&
                     !wxFileExists(filename) )
     {
@@ -1470,5 +1467,5 @@
 
     // change to the directory where the user went if asked
-    if ( m_dialogStyle & wxCHANGE_DIR )
+    if ( HasFlag(wxFD_CHANGE_DIR) )
     {
         wxString cwd;
Index: src/generic/prntdlgg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/generic/prntdlgg.cpp,v
retrieving revision 1.85
diff -bu2 -r1.85 src/generic/prntdlgg.cpp
--- src/generic/prntdlgg.cpp
+++ src/generic/prntdlgg.cpp
@@ -296,5 +296,5 @@
 
         wxFileDialog dialog( this, _("PostScript file"),
-            fname.GetPath(), fname.GetFullName(), wxT("*.ps"), wxSAVE | wxOVERWRITE_PROMPT );
+            fname.GetPath(), fname.GetFullName(), wxT("*.ps"), wxFD_SAVE | wxFD_OVERWRITE_PROMPT );
         if (dialog.ShowModal() != wxID_OK) return;
 
Index: src/gtk/dirdlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/gtk/dirdlg.cpp,v
retrieving revision 1.8
diff -bu2 -r1.8 src/gtk/dirdlg.cpp
--- src/gtk/dirdlg.cpp
+++ src/gtk/dirdlg.cpp
@@ -1,5 +1,5 @@
 /////////////////////////////////////////////////////////////////////////////
 // Name:        src/gtk/dirdlg.cpp
-// Purpose:     native implementation of wxDirDialogGTK
+// Purpose:     native implementation of wxDirDialog
 // Author:      Robert Roebling, Zbigniew Zagorski, Mart Raudsepp, Francesco Montorsi
 // Id:          $Id: dirdlg.cpp,v 1.8 2006/05/11 17:15:57 MR Exp $
@@ -14,5 +14,5 @@
 
 /*
-  NOTE: the GtkFileChooser interface can be used both for wxFileDialog and for wxDirDialogGTK.
+  NOTE: the GtkFileChooser interface can be used both for wxFileDialog and for wxDirDialog.
         Thus following code is very similar (even if not identic) to src/gtk/filedlg.cpp
         If you find a problem in this code, remember to check also that file !
@@ -21,5 +21,5 @@
 
 
-#if wxUSE_DIRDLG
+#if wxUSE_DIRDLG && defined( __WXGTK24__ )
 
 #include "wx/dirdlg.h"
@@ -30,6 +30,4 @@
 #endif
 
-#ifdef __WXGTK24__      // only for GTK+ > 2.4 there is GtkFileChooserDialog
-
 #include <gtk/gtk.h>
 #include "wx/gtk/private.h"
@@ -49,5 +47,5 @@
 
 extern "C" {
-static void gtk_filedialog_ok_callback(GtkWidget *widget, wxDirDialogGTK *dialog)
+static void gtk_filedialog_ok_callback(GtkWidget *widget, wxDirDialog *dialog)
 {
     gchar* filename = gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(widget));
@@ -71,5 +69,5 @@
 extern "C" {
 static void gtk_filedialog_cancel_callback(GtkWidget *WXUNUSED(w),
-                                           wxDirDialogGTK *dialog)
+                                           wxDirDialog *dialog)
 {
     wxCommandEvent event(wxEVT_COMMAND_BUTTON_CLICKED, wxID_CANCEL);
@@ -82,5 +80,5 @@
 static void gtk_filedialog_response_callback(GtkWidget *w,
                                              gint response,
-                                             wxDirDialogGTK *dialog)
+                                             wxDirDialog *dialog)
 {
     wxapp_install_idle_handler();
@@ -98,22 +96,19 @@
 }
 
-#endif // __WXGTK24__
-
 //-----------------------------------------------------------------------------
-// wxDirDialogGTK
+// wxDirDialog
 //-----------------------------------------------------------------------------
 
-IMPLEMENT_DYNAMIC_CLASS(wxDirDialogGTK,wxGenericDirDialog)
+IMPLEMENT_DYNAMIC_CLASS(wxDirDialog,wxGenericDirDialog)
 
-BEGIN_EVENT_TABLE(wxDirDialogGTK,wxGenericDirDialog)
-    EVT_BUTTON(wxID_OK, wxDirDialogGTK::OnFakeOk)
+BEGIN_EVENT_TABLE(wxDirDialog,wxGenericDirDialog)
+    EVT_BUTTON(wxID_OK, wxDirDialog::OnFakeOk)
 END_EVENT_TABLE()
 
-wxDirDialogGTK::wxDirDialogGTK(wxWindow* parent, const wxString& title,
+wxDirDialog::wxDirDialog(wxWindow* parent, const wxString& title,
                         const wxString& defaultPath, long style,
                         const wxPoint& pos, const wxSize& sz,
                         const wxString& name)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -126,5 +121,5 @@
                     wxDefaultValidator, wxT("filedialog")))
         {
-            wxFAIL_MSG( wxT("wxDirDialogGTK creation failed") );
+            wxFAIL_MSG( wxT("wxDirDialog creation failed") );
             return;
         }
@@ -135,6 +130,7 @@
             gtk_parent = GTK_WINDOW( gtk_widget_get_toplevel(parent->m_widget) );
 
+        if (HasFlag(wxDD_DIR_MUST_EXIST))
         gtk_action = GTK_FILE_CHOOSER_ACTION_SELECT_FOLDER;
-        if (style & wxDD_NEW_DIR_BUTTON)
+        else
             gtk_action = GTK_FILE_CHOOSER_ACTION_CREATE_FOLDER;
 
@@ -164,11 +160,9 @@
     }
     else
-#endif
         wxGenericDirDialog::Create(parent, title, defaultPath, style, pos, sz, name);
 }
 
-wxDirDialogGTK::~wxDirDialogGTK()
+wxDirDialog::~wxDirDialog()
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -176,38 +170,31 @@
             m_widget = NULL;
     }
-#endif
 }
 
-void wxDirDialogGTK::OnFakeOk( wxCommandEvent &event )
+void wxDirDialog::OnFakeOk( wxCommandEvent &event )
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         wxDialog::OnOK( event );
     else
-#endif
         wxGenericDirDialog::OnOK( event );
 }
 
-int wxDirDialogGTK::ShowModal()
+int wxDirDialog::ShowModal()
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxDialog::ShowModal();
     else
-#endif
         return wxGenericDirDialog::ShowModal();
 }
 
-bool wxDirDialogGTK::Show( bool show )
+bool wxDirDialog::Show( bool show )
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxDialog::Show( show );
     else
-#endif
         return wxGenericDirDialog::Show( show );
 }
 
-void wxDirDialogGTK::DoSetSize(int x, int y, int width, int height, int sizeFlags )
+void wxDirDialog::DoSetSize(int x, int y, int width, int height, int sizeFlags )
 {
     if (!m_wxwindow)
@@ -217,7 +204,6 @@
 }
 
-void wxDirDialogGTK::SetPath(const wxString& dir)
+void wxDirDialog::SetPath(const wxString& dir)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -228,15 +214,12 @@
     }
     else
-#endif
         wxGenericDirDialog::SetPath( dir );
 }
 
-wxString wxDirDialogGTK::GetPath() const
+wxString wxDirDialog::GetPath() const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxConvFileName->cMB2WX( gtk_file_chooser_get_filename( GTK_FILE_CHOOSER(m_widget) ) );
     else
-#endif
         return wxGenericDirDialog::GetPath();
 }
Index: src/gtk/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/gtk/filedlg.cpp,v
retrieving revision 1.72
diff -bu2 -r1.72 src/gtk/filedlg.cpp
--- src/gtk/filedlg.cpp
+++ src/gtk/filedlg.cpp
@@ -11,5 +11,5 @@
 #include "wx/wxprec.h"
 
-#if wxUSE_FILEDLG
+#if wxUSE_FILEDLG && defined(__WXGTK24__)
 
 #include "wx/filedlg.h"
@@ -19,6 +19,4 @@
 #endif
 
-#ifdef __WXGTK24__
-
 #include <gtk/gtk.h>
 #include "wx/gtk/private.h"
@@ -44,5 +42,5 @@
 static void gtk_filedialog_ok_callback(GtkWidget *widget, wxFileDialog *dialog)
 {
-    int style = dialog->GetStyle();
+    int style = dialog->GetWindowStyle();
     gchar* filename = gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(widget));
 
@@ -51,5 +49,5 @@
     if(gtk_check_version(2,7,3) != NULL)
 #endif
-    if ((style & wxSAVE) && (style & wxOVERWRITE_PROMPT))
+    if ((style & wxFD_SAVE) && (style & wxFD_OVERWRITE_PROMPT))
     {
         if ( g_file_test(filename, G_FILE_TEST_EXISTS) )
@@ -69,5 +67,5 @@
 
     // change to the directory where the user went if asked
-    if (style & wxCHANGE_DIR)
+    if (style & wxFD_CHANGE_DIR)
     {
         // Use chdir to not care about filename encodings
@@ -118,5 +116,4 @@
 }
 
-#endif // __WXGTK24__
 
 //-----------------------------------------------------------------------------
@@ -134,12 +131,12 @@
                            const wxString& defaultFileName,
                            const wxString& wildCard,
-                           long style, const wxPoint& pos)
+                           long style, const wxPoint& pos,
+                           const wxSize& sz,
+                           const wxString& name)
     : wxGenericFileDialog(parent, message, defaultDir, defaultFileName,
-                       wildCard, style, pos, true )
+                          wildCard, style, pos, sz, name, true )
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
-        wxASSERT_MSG( !( (style & wxSAVE) && (style & wxMULTIPLE) ), wxT("wxFileDialog - wxMULTIPLE used on a save dialog" ) );
         m_needParent = false;
         m_destroyed_by_delete = false;
@@ -159,5 +156,5 @@
 
         const gchar* ok_btn_stock;
-        if ( style & wxSAVE )
+        if ( style & wxFD_SAVE )
         {
             gtk_action = GTK_FILE_CHOOSER_ACTION_SAVE;
@@ -180,5 +177,5 @@
         gtk_dialog_set_default_response(GTK_DIALOG(m_widget), GTK_RESPONSE_ACCEPT);
 
-        if ( style & wxMULTIPLE )
+        if ( style & wxFD_MULTIPLE )
             gtk_file_chooser_set_select_multiple(GTK_FILE_CHOOSER(m_widget), true);
 
@@ -195,5 +192,5 @@
         SetWildcard(wildCard);
 
-        if ( style & wxSAVE )
+        if ( style & wxFD_SAVE )
         {
             if ( !defaultDir.empty() )
@@ -229,5 +226,4 @@
     }
     else
-#endif
         wxGenericFileDialog::Create( parent, message, defaultDir, defaultFileName, wildCard, style, pos );
 }
@@ -235,5 +231,4 @@
 wxFileDialog::~wxFileDialog()
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -241,14 +236,11 @@
             m_widget = NULL;
     }
-#endif
 }
 
 void wxFileDialog::OnFakeOk( wxCommandEvent &event )
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         wxDialog::OnOK( event );
     else
-#endif
         wxGenericFileDialog::OnListOk( event );
 }
@@ -256,9 +248,7 @@
 int wxFileDialog::ShowModal()
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxDialog::ShowModal();
     else
-#endif
         return wxGenericFileDialog::ShowModal();
 }
@@ -266,9 +256,7 @@
 bool wxFileDialog::Show( bool show )
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxDialog::Show( show );
     else
-#endif
         return wxGenericFileDialog::Show( show );
 }
@@ -284,9 +272,7 @@
 wxString wxFileDialog::GetPath() const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxConvFileName->cMB2WX(gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(m_widget)));
     else
-#endif
         return wxGenericFileDialog::GetPath();
 }
@@ -294,5 +280,4 @@
 void wxFileDialog::GetFilenames(wxArrayString& files) const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -305,5 +290,4 @@
     }
     else
-#endif
         wxGenericFileDialog::GetFilenames( files );
 }
@@ -311,5 +295,4 @@
 void wxFileDialog::GetPaths(wxArrayString& paths) const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -333,5 +316,4 @@
     }
     else
-#endif
         wxGenericFileDialog::GetPaths( paths );
 }
@@ -339,5 +321,4 @@
 void wxFileDialog::SetMessage(const wxString& message)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -346,5 +327,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetMessage( message );
 }
@@ -352,5 +332,4 @@
 void wxFileDialog::SetPath(const wxString& path)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -360,5 +339,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetPath( path );
 }
@@ -366,5 +344,4 @@
 void wxFileDialog::SetDirectory(const wxString& dir)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -375,5 +352,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetDirectory( dir );
 }
@@ -381,10 +357,8 @@
 wxString wxFileDialog::GetDirectory() const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxConvFileName->cMB2WX(
             gtk_file_chooser_get_current_folder( GTK_FILE_CHOOSER(m_widget) ) );
     else
-#endif
         return wxGenericFileDialog::GetDirectory();
 }
@@ -392,8 +366,7 @@
 void wxFileDialog::SetFilename(const wxString& name)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
-        if (GetStyle() & wxSAVE)
+        if (HasFlag(wxFD_SAVE))
             gtk_file_chooser_set_current_name(GTK_FILE_CHOOSER(m_widget), wxConvFileName->cWX2MB(name));
         else
@@ -401,5 +374,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetFilename( name );
 }
@@ -407,10 +379,8 @@
 wxString wxFileDialog::GetFilename() const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
         return wxFileName(
             wxConvFileName->cMB2WX(gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(m_widget))) ).GetFullName();
     else
-#endif
         return wxGenericFileDialog::GetFilename();
 }
@@ -418,5 +388,4 @@
 void wxFileDialog::SetWildcard(const wxString& wildCard)
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -466,5 +435,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetWildcard( wildCard );
 }
@@ -472,5 +440,5 @@
 void wxFileDialog::SetFilterIndex(int filterIndex)
 {
-#ifdef __WXGTK24__
+
     if (!gtk_check_version(2,4,0))
     {
@@ -493,5 +461,4 @@
     }
     else
-#endif
         wxGenericFileDialog::SetFilterIndex( filterIndex );
 }
@@ -499,5 +466,4 @@
 int wxFileDialog::GetFilterIndex() const
 {
-#ifdef __WXGTK24__
     if (!gtk_check_version(2,4,0))
     {
@@ -517,7 +483,6 @@
     }
     else
-#endif
                 return wxGenericFileDialog::GetFilterIndex();
 }
 
-#endif // wxUSE_FILEDLG
+#endif // wxUSE_FILEDLG &&  __WXGTK24__
Index: src/gtk1/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/gtk1/filedlg.cpp,v
retrieving revision 1.71
diff -bu2 -r1.71 src/gtk1/filedlg.cpp
--- src/gtk1/filedlg.cpp
+++ src/gtk1/filedlg.cpp
@@ -30,9 +30,11 @@
                            const wxString& defaultFileName,
                            const wxString& wildCard,
-                           long style, const wxPoint& pos)
+                           long style, const wxPoint& pos,
+                           const wxSize& sz,
+                           const wxString& name)
     : wxGenericFileDialog(parent, message, defaultDir, defaultFileName,
-                       wildCard, style, pos, true )
+                       wildCard, style, pos, sz, name, true )
 {
-        wxGenericFileDialog::Create( parent, message, defaultDir, defaultFileName, wildCard, style, pos );
+        wxGenericFileDialog::Create( parent, message, defaultDir, defaultFileName, wildCard, style, pos, sz, name );
 }
 
Index: src/html/helpwnd.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/html/helpwnd.cpp,v
retrieving revision 1.8
diff -bu2 -r1.8 src/html/helpwnd.cpp
--- src/html/helpwnd.cpp
+++ src/html/helpwnd.cpp
@@ -1541,5 +1541,5 @@
                                             wxEmptyString,
                                             filemask,
-                                            wxOPEN | wxFILE_MUST_EXIST,
+                                            wxFD_OPEN | wxFD_FILE_MUST_EXIST,
                                             this);
                 if (!s.empty())
Index: src/mac/carbon/dirdlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/mac/carbon/dirdlg.cpp,v
retrieving revision 1.25
diff -bu2 -r1.25 src/mac/carbon/dirdlg.cpp
--- src/mac/carbon/dirdlg.cpp
+++ src/mac/carbon/dirdlg.cpp
@@ -73,5 +73,5 @@
     wxASSERT_MSG( NavServicesAvailable() , wxT("Navigation Services are not running") ) ;
     m_message = message;
-    m_dialogStyle = style;
+    m_windowStyle = style;
     m_parent = parent;
     m_path = defaultPath;
Index: src/mac/carbon/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/mac/carbon/filedlg.cpp,v
retrieving revision 1.63
diff -bu2 -r1.63 src/mac/carbon/filedlg.cpp
--- src/mac/carbon/filedlg.cpp
+++ src/mac/carbon/filedlg.cpp
@@ -260,6 +260,6 @@
     wxWindow *parent, const wxString& message,
     const wxString& defaultDir, const wxString& defaultFileName, const wxString& wildCard,
-    long style, const wxPoint& pos)
-    : wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos)
+    long style, const wxPoint& pos, const wxSize& sz, const wxString& name)
+    : wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos, sz, name)
 {
     wxASSERT_MSG( NavServicesAvailable() , wxT("Navigation Services are not running") ) ;
@@ -339,5 +339,5 @@
     }
 
-    if (m_dialogStyle & wxSAVE)
+    if (HasFlag(wxFD_SAVE))
     {
         myData.saveMode = true;
@@ -353,5 +353,5 @@
 
 #if TARGET_API_MAC_OSX
-        if (!(m_dialogStyle & wxOVERWRITE_PROMPT))
+        if (!(m_windowStyle & wxOVERWRITE_PROMPT))
             dialogCreateOptions.optionFlags |= kNavDontConfirmReplacement;
 #endif
@@ -414,5 +414,5 @@
                 break;
 
-            if (m_dialogStyle & wxSAVE)
+            if (HasFlag(wxFD_SAVE))
                 thePath = wxMacFSRefToPath( &theFSRef, navReply.saveFileName );
             else
Index: src/mac/classic/dirdlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/mac/classic/dirdlg.cpp,v
retrieving revision 1.7
diff -bu2 -r1.7 src/mac/classic/dirdlg.cpp
--- src/mac/classic/dirdlg.cpp
+++ src/mac/classic/dirdlg.cpp
@@ -46,5 +46,5 @@
     wxASSERT_MSG( NavServicesAvailable() , wxT("Navigation Services are not running") ) ;
     m_message = message;
-    m_dialogStyle = style;
+    m_windowStyle = style;
     m_parent = parent;
     m_path = defaultPath;
Index: src/mac/classic/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/mac/classic/filedlg.cpp,v
retrieving revision 1.9
diff -bu2 -r1.9 src/mac/classic/filedlg.cpp
--- src/mac/classic/filedlg.cpp
+++ src/mac/classic/filedlg.cpp
@@ -293,6 +293,6 @@
 wxFileDialog::wxFileDialog(wxWindow *parent, const wxString& message,
         const wxString& defaultDir, const wxString& defaultFileName, const wxString& wildCard,
-        long style, const wxPoint& pos)
-             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos)
+        long style, const wxPoint& pos, const wxSize& sz, const wxString& name)
+             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos, sz, name)
 {
     wxASSERT_MSG( NavServicesAvailable() , wxT("Navigation Services are not running") ) ;
@@ -373,5 +373,5 @@
     myData.defaultLocation = m_dir;
 
-    if (m_dialogStyle & wxSAVE)
+    if (HasFlag(wxFD_SAVE))
     {
         dialogCreateOptions.optionFlags |= kNavNoTypePopup;
@@ -446,5 +446,5 @@
 
             CFURLRef fullURLRef;
-            if (m_dialogStyle & wxSAVE)
+            if (HasFlag(wxFD_SAVE))
             {
                 CFURLRef parentURLRef = ::CFURLCreateFromFSRef(NULL, &theFSRef);
@@ -563,5 +563,5 @@
         }
     }
-    if ( m_dialogStyle & wxSAVE )
+    if ( HasFlag(wxFD_SAVE) )
     {
         myData.saveMode = true ;
@@ -585,5 +585,5 @@
 
         mNavFilterUPP = NewNavObjectFilterUPP( CrossPlatformFilterCallback ) ;
-        if ( m_dialogStyle & wxMULTIPLE )
+        if ( m_windowStyle & wxMULTIPLE )
             mNavOptions.dialogOptionFlags |= kNavAllowMultipleFiles ;
         else
Index: src/motif/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/motif/filedlg.cpp,v
retrieving revision 1.39
diff -bu2 -r1.39 src/motif/filedlg.cpp
--- src/motif/filedlg.cpp
+++ src/motif/filedlg.cpp
@@ -118,6 +118,6 @@
 wxFileDialog::wxFileDialog(wxWindow *parent, const wxString& message,
                            const wxString& defaultDir, const wxString& defaultFileName, const wxString& wildCard,
-                           long style, const wxPoint& pos)
-             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos)
+                           long style, const wxPoint& pos, const wxSize& sz, const wxString& name)
+             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos, sz, name)
 {
     m_filterIndex = 1;
Index: src/msw/dirdlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/msw/dirdlg.cpp,v
retrieving revision 1.44
diff -bu2 -r1.44 src/msw/dirdlg.cpp
--- src/msw/dirdlg.cpp
+++ src/msw/dirdlg.cpp
@@ -149,5 +149,5 @@
     //
     // "new" style is only available in the version 5.0+ of comctl32.dll
-    const bool needNewDir = HasFlag(wxDD_NEW_DIR_BUTTON);
+    const bool needNewDir = !HasFlag(wxDD_DIR_MUST_EXIST);
     if ( (needNewDir || HasFlag(wxRESIZE_BORDER)) && (verComCtl32 >= 500) )
     {
Index: src/msw/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/msw/filedlg.cpp,v
retrieving revision 1.85
diff -bu2 -r1.85 src/msw/filedlg.cpp
--- src/msw/filedlg.cpp
+++ src/msw/filedlg.cpp
@@ -130,11 +130,13 @@
                            const wxString& wildCard,
                            long style,
-                           const wxPoint& pos)
+                           const wxPoint& pos,
+                           const wxSize& sz,
+                           const wxString& name)
             : wxFileDialogBase(parent, message, defaultDir, defaultFileName,
-                               wildCard, style, pos)
+                               wildCard, style, pos, sz, name)
 
 {
-    if ( ( m_dialogStyle & wxMULTIPLE ) && ( m_dialogStyle & wxSAVE ) )
-        m_dialogStyle &= ~wxMULTIPLE;
+    if ( ( m_windowStyle & wxMULTIPLE ) && ( m_windowStyle & wxSAVE ) )
+        m_windowStyle &= ~wxMULTIPLE;
 
     m_bMovedWindow = false;
@@ -279,5 +281,5 @@
 #if WXWIN_COMPATIBILITY_2_4
     long msw_flags = 0;
-    if ( (m_dialogStyle & wxHIDE_READONLY) || (m_dialogStyle & wxSAVE) )
+    if ( (m_windowStyle & wxHIDE_READONLY) || (m_windowStyle & wxSAVE) )
         msw_flags |= OFN_HIDEREADONLY;
 #else
@@ -285,5 +287,5 @@
 #endif
 
-    if ( m_dialogStyle & wxFILE_MUST_EXIST )
+    if ( m_windowStyle & wxFILE_MUST_EXIST )
         msw_flags |= OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;
     /*
@@ -303,5 +305,5 @@
     }
 
-    if (m_dialogStyle & wxMULTIPLE )
+    if (m_windowStyle & wxMULTIPLE )
     {
         // OFN_EXPLORER must always be specified with OFN_ALLOWMULTISELECT
@@ -312,10 +314,10 @@
     // standard dialog does by default (notice that under NT it does it anyhow,
     // OFN_NOCHANGEDIR or not, see below)
-    if ( !(m_dialogStyle & wxCHANGE_DIR) )
+    if ( !(m_windowStyle & wxCHANGE_DIR) )
     {
         msw_flags |= OFN_NOCHANGEDIR;
     }
 
-    if ( m_dialogStyle & wxOVERWRITE_PROMPT )
+    if ( m_windowStyle & wxOVERWRITE_PROMPT )
     {
         msw_flags |= OFN_OVERWRITEPROMPT;
@@ -414,5 +416,5 @@
     // to check for "foo.bar" existence and not "foo")
     wxString defextBuffer; // we need it to be alive until GetSaveFileName()!
-    if (m_dialogStyle & wxSAVE)
+    if (m_windowStyle & wxSAVE)
     {
         const wxChar* extension = filterBuffer;
@@ -437,5 +439,5 @@
 
     DWORD errCode;
-    bool success = DoShowCommFileDialog(&of, m_dialogStyle, &errCode);
+    bool success = DoShowCommFileDialog(&of, m_windowStyle, &errCode);
 
 #ifdef wxTRY_SMALLER_OPENFILENAME
@@ -447,5 +449,5 @@
         of.lStructSize = wxOPENFILENAME_V4_SIZE;
 
-        success = DoShowCommFileDialog(&of, m_dialogStyle, &errCode);
+        success = DoShowCommFileDialog(&of, m_windowStyle, &errCode);
 
         if ( success || !errCode )
@@ -471,5 +473,5 @@
         m_fileNames.Empty();
 
-        if ( ( m_dialogStyle & wxMULTIPLE ) &&
+        if ( ( m_windowStyle & wxMULTIPLE ) &&
 #if defined(OFN_EXPLORER)
              ( fileNameBuffer[of.nFileOffset-1] == wxT('\0') )
Index: src/msw/wince/filedlgwce.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/msw/wince/filedlgwce.cpp,v
retrieving revision 1.10
diff -bu2 -r1.10 src/msw/wince/filedlgwce.cpp
--- src/msw/wince/filedlgwce.cpp
+++ src/msw/wince/filedlgwce.cpp
@@ -71,7 +71,7 @@
 {
     m_message = message;
-    m_dialogStyle = style;
-    if ( ( m_dialogStyle & wxMULTIPLE ) && ( m_dialogStyle & wxSAVE ) )
-        m_dialogStyle &= ~wxMULTIPLE;
+    m_windowStyle = style;
+    if ( ( m_windowStyle & wxMULTIPLE ) && ( m_windowStyle & wxSAVE ) )
+        m_windowStyle &= ~wxMULTIPLE;
     m_parent = parent;
     m_path = wxEmptyString;
Index: src/os2/dirdlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/os2/dirdlg.cpp,v
retrieving revision 1.10
diff -bu2 -r1.10 src/os2/dirdlg.cpp
--- src/os2/dirdlg.cpp
+++ src/os2/dirdlg.cpp
@@ -36,5 +36,5 @@
 {
     m_message = message;
-    m_dialogStyle = style;
+    m_windowStyle = style;
     m_parent = parent;
     m_path = defaultPath;
Index: src/os2/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/os2/filedlg.cpp,v
retrieving revision 1.17
diff -bu2 -r1.17 src/os2/filedlg.cpp
--- src/os2/filedlg.cpp
+++ src/os2/filedlg.cpp
@@ -72,11 +72,13 @@
 , const wxString&                   rsWildCard
 , long                              lStyle
-, const wxPoint&                    rPos
+, const wxPoint&                    rPos,
+  const wxSize& sz,
+  const wxString& name
 )
-    :wxFileDialogBase(pParent, rsMessage, rsDefaultDir, rsDefaultFileName, rsWildCard, lStyle, rPos)
+    :wxFileDialogBase(pParent, rsMessage, rsDefaultDir, rsDefaultFileName, rsWildCard, lStyle, rPos, sz, name)
 
 {
-    if ((m_dialogStyle & wxMULTIPLE) && (m_dialogStyle & wxSAVE))
-        m_dialogStyle &= ~wxMULTIPLE;
+    if ((m_windowStyle & wxMULTIPLE) && (m_windowStyle & wxSAVE))
+        m_windowStyle &= ~wxMULTIPLE;
 
     m_filterIndex = 1;
@@ -125,5 +127,5 @@
     *zTitleBuffer    = wxT('\0');
 
-    if (m_dialogStyle & wxSAVE)
+    if (m_windowStyle & wxSAVE)
         lFlags = FDS_SAVEAS_DIALOG;
     else
@@ -131,11 +133,11 @@
 
 #if WXWIN_COMPATIBILITY_2_4
-    if (m_dialogStyle & wxHIDE_READONLY)
+    if (m_windowStyle & wxHIDE_READONLY)
         lFlags |= FDS_SAVEAS_DIALOG;
 #endif
 
-    if (m_dialogStyle & wxSAVE)
+    if (m_windowStyle & wxSAVE)
         lFlags |= FDS_SAVEAS_DIALOG;
-    if (m_dialogStyle & wxMULTIPLE )
+    if (m_windowStyle & wxMULTIPLE )
         lFlags |= FDS_OPEN_DIALOG | FDS_MULTIPLESEL;
 
@@ -223,5 +225,5 @@
     {
         m_fileNames.Empty();
-        if ((m_dialogStyle & wxMULTIPLE ) && vFileDlg.ulFQFCount > 1)
+        if ((m_windowStyle & wxMULTIPLE ) && vFileDlg.ulFQFCount > 1)
         {
             for (int i = 0; i < (int)vFileDlg.ulFQFCount; i++)
@@ -237,5 +239,5 @@
             ::WinFreeFileDlgList(vFileDlg.papszFQFilename);
         }
-        else if (!(m_dialogStyle & wxSAVE))
+        else if (!(m_windowStyle & wxSAVE))
         {
             m_path = (wxChar*)vFileDlg.szFullFile;
@@ -302,6 +304,6 @@
             // === Simulating the wxOVERWRITE_PROMPT >>============================
             //
-            if ((m_dialogStyle & wxOVERWRITE_PROMPT) &&
-                (m_dialogStyle & wxSAVE) &&
+            if ((m_windowStyle & wxOVERWRITE_PROMPT) &&
+                (m_windowStyle & wxSAVE) &&
                 (wxFileExists(m_path.c_str())))
             {
Index: src/palmos/filedlg.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/palmos/filedlg.cpp,v
retrieving revision 1.4
diff -bu2 -r1.4 src/palmos/filedlg.cpp
--- src/palmos/filedlg.cpp
+++ src/palmos/filedlg.cpp
@@ -76,6 +76,8 @@
                            const wxString& wildCard,
                            long style,
-                           const wxPoint& pos)
-             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos)
+                           const wxPoint& pos,
+                           const wxSize& sz,
+                           const wxString& name)
+             :wxFileDialogBase(parent, message, defaultDir, defaultFileName, wildCard, style, pos, sz, name)
 
 {
Index: utils/configtool/src/configtoolview.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/utils/configtool/src/configtoolview.cpp,v
retrieving revision 1.12
diff -bu2 -r1.12 utils/configtool/src/configtoolview.cpp
--- utils/configtool/src/configtoolview.cpp
+++ utils/configtool/src/configtoolview.cpp
@@ -914,5 +914,5 @@
         _("Save Setup File As"),
         path, filename ,
-        wildcard, wxSAVE|wxOVERWRITE_PROMPT);
+        wildcard, wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
 
     if (dialog.ShowModal() == wxID_OK)
@@ -947,5 +947,5 @@
         _("Save Configure Command File As"),
         path, filename ,
-        wildcard, wxSAVE|wxOVERWRITE_PROMPT);
+        wildcard, wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
 
     if (dialog.ShowModal() == wxID_OK)
Index: utils/helpview/src/helpview.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/utils/helpview/src/helpview.cpp,v
retrieving revision 1.17
diff -bu2 -r1.17 utils/helpview/src/helpview.cpp
--- utils/helpview/src/helpview.cpp
+++ utils/helpview/src/helpview.cpp
@@ -153,5 +153,5 @@
             wxEmptyString,
             wxT("Help books (*.htb)|*.htb|Help books (*.zip)|*.zip|HTML Help Project (*.hhp)|*.hhp"),
-            wxOPEN | wxFILE_MUST_EXIST,
+            wxFD_OPEN | wxFD_FILE_MUST_EXIST,
             NULL);
 
@@ -260,5 +260,5 @@
         "Help books (*.htb)|*.htb|Help books (*.zip)|*.zip|\
         HTML Help Project (*.hhp)|*.hhp"),
-        wxOPEN | wxFILE_MUST_EXIST,
+        wxFD_OPEN | wxFD_FILE_MUST_EXIST,
         NULL);
 

 	  	 
