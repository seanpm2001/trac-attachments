Index: configure
===================================================================
--- configure	(revision 63626)
+++ configure	(working copy)
@@ -39445,7 +39445,7 @@
     if test "$wxUSE_THREADS" = "yes" ; then
 
 
-                                THREAD_OPTS="-pthread"
+                                THREAD_OPTS=""
         if test "x$SUNCXX" = xyes; then
             THREAD_OPTS="-mt lthread $THREAD_OPTS"
         fi
@@ -39453,7 +39453,7 @@
         case "${host}" in
           *-*-solaris2* | *-*-sunos4* )
                 if test "x$GCC" = "xyes"; then
-                                        THREAD_OPTS="-pthreads $THREAD_OPTS"
+                                        THREAD_OPTS="$THREAD_OPTS"
                 fi
                 ;;
           *-*-freebsd*)
@@ -49838,6 +49838,7 @@
       *-*-osf* | \
       *-*-dgux5* | \
       *-*-sysv5* | \
+      *-*-qnx* | \
       *-pc-msdosdjgpp )
               ;;
 
Index: src/unix/threadpsx.cpp
===================================================================
--- src/unix/threadpsx.cpp	(revision 63626)
+++ src/unix/threadpsx.cpp	(working copy)
@@ -29,6 +29,10 @@
 #include "wx/thread.h"
 #include "wx/except.h"
 
+#ifdef __QNX__
+    #include <sys/time.h>
+#endif
+
 #ifndef WX_PRECOMP
     #include "wx/app.h"
     #include "wx/dynarray.h"
Index: src/unix/dialup.cpp
===================================================================
--- src/unix/dialup.cpp	(revision 63626)
+++ src/unix/dialup.cpp	(working copy)
@@ -684,7 +684,7 @@
         cmd << wxT(" -a");
 #elif defined(__LINUX__) || defined(__SGI__)
         // nothing to be added to ifconfig
-#elif defined(__FREEBSD__) || defined(__DARWIN__)
+#elif defined(__FREEBSD__) || defined(__DARWIN__) || defined(__QNX__)
         // add -l flag
         cmd << wxT(" -l");
 #elif defined(__HPUX__)
@@ -723,7 +723,7 @@
                     // dialup device under SunOS/Solaris
                     hasModem = strstr(output.fn_str(),"ipdptp") != NULL;
                     hasLAN = strstr(output.fn_str(), "hme") != NULL;
-#elif defined(__LINUX__) || defined (__FREEBSD__)
+#elif defined(__LINUX__) || defined (__FREEBSD__) || defined (__QNX__)
                     hasModem = strstr(output.fn_str(),"ppp")    // ppp
                         || strstr(output.fn_str(),"sl")  // slip
                         || strstr(output.fn_str(),"pl"); // plip
@@ -799,7 +799,8 @@
       defined(__LINUX__) || \
       defined(__OSF__) || \
       defined(__SGI__) || \
-      defined(__VMS)
+      defined(__VMS) || \
+      defined(__QNX__)
     cmd << wxT("-c 1 "); // only ping once
 #elif defined(__HPUX__)
     cmd << wxT("64 1 "); // only ping once (need also specify the packet size)
Index: src/unix/appunix.cpp
===================================================================
--- src/unix/appunix.cpp	(revision 63626)
+++ src/unix/appunix.cpp	(working copy)
@@ -10,6 +10,10 @@
 
 #include "wx/wxprec.h"
 
+#ifdef __QNX__
+   #define SA_RESTART 0
+#endif
+
 #ifdef __BORLANDC__
     #pragma hdrstop
 #endif
Index: src/propgrid/propgrid.cpp
===================================================================
--- src/propgrid/propgrid.cpp	(revision 63626)
+++ src/propgrid/propgrid.cpp	(working copy)
@@ -4821,7 +4821,7 @@
         {
 
             int newSplitterX = x - m_dragOffset;
-            int splitterX = x - splitterHitOffset;
+            //int splitterX = x - splitterHitOffset; already defined above
 
             // Splitter redraw required?
             if ( newSplitterX != splitterX )
Index: src/stc/PlatWX.cpp
===================================================================
--- src/stc/PlatWX.cpp	(revision 63626)
+++ src/stc/PlatWX.cpp	(working copy)
@@ -753,6 +753,8 @@
     int n = wxDisplay::GetFromPoint(wxPoint(pt.x, pt.y));
     wxDisplay dpy(n == wxNOT_FOUND ? 0 : n);
     rect = dpy.GetGeometry();
+#else
+    pt=pt;    
 #endif
     return PRectangleFromwxRect(rect);
 }
Index: src/tiff/libtiff/tiffconf.h
===================================================================
--- src/tiff/libtiff/tiffconf.h	(revision 63626)
+++ src/tiff/libtiff/tiffconf.h	(working copy)
@@ -1,4 +1,4 @@
-/* libtiff/tiffconf.h.  Generated by configure.  */
+/* libtiff/tiffconf.h.  Generated from tiffconf.h.in by configure.  */
 /*
   Configuration defines for installed libtiff.
   This file maintained for backward compatibility. Do not use definitions
@@ -30,7 +30,7 @@
 #define HAVE_IEEEFP 1
 
 /* Set the native cpu bit order (FILLORDER_LSB2MSB or FILLORDER_MSB2LSB) */
-#define HOST_FILLORDER FILLORDER_LSB2MSB
+#define HOST_FILLORDER FILLORDER_MSB2LSB
 
 /* Native cpu byte order: 1 if big-endian (Motorola) or 0 if little-endian
    (Intel) */
@@ -40,7 +40,7 @@
 #define CCITT_SUPPORT 1
 
 /* Support JPEG compression (requires IJG JPEG library) */
-#define JPEG_SUPPORT 1
+/* #undef JPEG_SUPPORT */
 
 /* Support LogLuv high dynamic range encoding */
 #define LOGLUV_SUPPORT 1
Index: src/tiff/libtiff/tif_config.h
===================================================================
--- src/tiff/libtiff/tif_config.h	(revision 63626)
+++ src/tiff/libtiff/tif_config.h	(working copy)
@@ -1,130 +1,261 @@
-#ifdef __APPLE__
+/* libtiff/tif_config.h.  Generated from tif_config.h.in by configure.  */
+/* libtiff/tif_config.h.in.  Generated from configure.ac by autoheader.  */
 
+/* Support CCITT Group 3 & 4 algorithms */
+#define CCITT_SUPPORT 1
+
+/* Pick up YCbCr subsampling info from the JPEG data stream to support files
+   lacking the tag (default enabled). */
+#define CHECK_JPEG_YCBCR_SUBSAMPLING 1
+
+/* Support C++ stream API (requires C++ compiler) */
+#define CXX_SUPPORT 1
+
+/* Treat extra sample as alpha (default enabled). The RGBA interface will
+   treat a fourth sample with no EXTRASAMPLE_ value as being ASSOCALPHA. Many
+   packages produce RGBA files but don't mark the alpha properly. */
+#define DEFAULT_EXTRASAMPLE_AS_ALPHA 1
+
+/* Use the Apple OpenGL framework. */
+/* #undef HAVE_APPLE_OPENGL_FRAMEWORK */
+
 /* Define to 1 if you have the <assert.h> header file. */
 #define HAVE_ASSERT_H 1
 
+/* Define to 1 if you have the <dlfcn.h> header file. */
+#define HAVE_DLFCN_H 1
+
 /* Define to 1 if you have the <fcntl.h> header file. */
 #define HAVE_FCNTL_H 1
 
+/* Define to 1 if you have the `floor' function. */
+#define HAVE_FLOOR 1
+
+/* Define to 1 if you have the `getopt' function. */
+#define HAVE_GETOPT 1
+
 /* Define as 0 or 1 according to the floating point format suported by the
    machine */
 #define HAVE_IEEEFP 1
 
-/* Define to 1 if you have the <string.h> header file. */
-#define HAVE_STRING_H 1
+/* Define to 1 if the system has the type `int16'. */
+/* #undef HAVE_INT16 */
 
-/* Define to 1 if you have the <sys/types.h> header file. */
-#define HAVE_SYS_TYPES_H 1
+/* Define to 1 if the system has the type `int32'. */
+/* #undef HAVE_INT32 */
 
-/* Define to 1 if you have the <io.h> header file. */
-/* #undef HAVE_IO_H */
+/* Define to 1 if the system has the type `int8'. */
+/* #undef HAVE_INT8 */
 
+/* Define to 1 if you have the <inttypes.h> header file. */
+#define HAVE_INTTYPES_H 1
+
+/* Define to 1 if you have the `isascii' function. */
+#define HAVE_ISASCII 1
+
+/* Define to 1 if you have the `lfind' function. */
+#define HAVE_LFIND 1
+
+/* Define to 1 if you have the `c' library (-lc). */
+#define HAVE_LIBC 1
+
+/* Define to 1 if you have the `m' library (-lm). */
+#define HAVE_LIBM 1
+
+/* Define to 1 if you have the <limits.h> header file. */
+#define HAVE_LIMITS_H 1
+
+/* Define to 1 if you have the <malloc.h> header file. */
+#define HAVE_MALLOC_H 1
+
+/* Define to 1 if you have the `memmove' function. */
+#define HAVE_MEMMOVE 1
+
+/* Define to 1 if you have the <memory.h> header file. */
+#define HAVE_MEMORY_H 1
+
+/* Define to 1 if you have the `memset' function. */
+#define HAVE_MEMSET 1
+
+/* Define to 1 if you have the `mmap' function. */
+#define HAVE_MMAP 1
+
+/* Define to 1 if you have the `pow' function. */
+#define HAVE_POW 1
+
+/* Define if you have POSIX threads libraries and header files. */
+#define HAVE_PTHREAD 1
+
 /* Define to 1 if you have the <search.h> header file. */
 #define HAVE_SEARCH_H 1
 
-/* The size of a `int', as computed by sizeof. */
-#define SIZEOF_INT 4
+/* Define to 1 if you have the `sqrt' function. */
+#define HAVE_SQRT 1
 
-/* The size of a `long', as computed by sizeof. */
-#ifdef __LP64__
-#define SIZEOF_LONG 8
-#else
-#define SIZEOF_LONG 4
-#endif
+/* Define to 1 if you have the <stdint.h> header file. */
+#define HAVE_STDINT_H 1
 
-#if __BIG_ENDIAN__
-    /* Set the native cpu bit order */
-    #define HOST_FILLORDER FILLORDER_MSB2LSB
-    
-    /* Define to 1 if your processor stores words with the most significant byte
-    first (like Motorola and SPARC, unlike Intel and VAX). */
-    #define WORDS_BIGENDIAN 1
-#else
-    /* Set the native cpu bit order */
-    #define HOST_FILLORDER FILLORDER_LSB2MSB
-    
-    /* Define to 1 if your processor stores words with the most significant byte
-        first (like Motorola and SPARC, unlike Intel and VAX). */
-    /* #undef WORDS_BIGENDIAN */
-#endif
+/* Define to 1 if you have the <stdlib.h> header file. */
+#define HAVE_STDLIB_H 1
 
-/* Define to `__inline__' or `__inline' if that's what the C compiler
-   calls it, or to nothing if 'inline' is not supported under any name.  */
-#ifndef __cplusplus
-# ifndef inline
-#  define inline __inline
-# endif
-#endif
+/* Define to 1 if you have the `strcasecmp' function. */
+#define HAVE_STRCASECMP 1
 
-#else /* __APPLE__ */
+/* Define to 1 if you have the `strchr' function. */
+#define HAVE_STRCHR 1
 
-/* Define to 1 if you have the <assert.h> header file. */
-#define HAVE_ASSERT_H 1
+/* Define to 1 if you have the <strings.h> header file. */
+#define HAVE_STRINGS_H 1
 
-/* Define to 1 if you have the <fcntl.h> header file. */
-#define HAVE_FCNTL_H 1
-
-/* Define as 0 or 1 according to the floating point format suported by the
-   machine */
-#define HAVE_IEEEFP 1
-
 /* Define to 1 if you have the <string.h> header file. */
 #define HAVE_STRING_H 1
 
+/* Define to 1 if you have the `strrchr' function. */
+#define HAVE_STRRCHR 1
+
+/* Define to 1 if you have the `strstr' function. */
+#define HAVE_STRSTR 1
+
+/* Define to 1 if you have the `strtol' function. */
+#define HAVE_STRTOL 1
+
+/* Define to 1 if you have the `strtoul' function. */
+#define HAVE_STRTOUL 1
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#define HAVE_SYS_STAT_H 1
+
+/* Define to 1 if you have the <sys/time.h> header file. */
+#define HAVE_SYS_TIME_H 1
+
 /* Define to 1 if you have the <sys/types.h> header file. */
 #define HAVE_SYS_TYPES_H 1
 
-/* Define to 1 if you have the <io.h> header file. */
-#define HAVE_IO_H 1
+/* Define to 1 if you have the <unistd.h> header file. */
+#define HAVE_UNISTD_H 1
 
-/* Define to 1 if you have the <search.h> header file. */
-#define HAVE_SEARCH_H 1
+/* Define to 1 if you have the <windows.h> header file. */
+/* #undef HAVE_WINDOWS_H */
 
+/* Native cpu byte order: 1 if big-endian (Motorola) or 0 if little-endian
+   (Intel) */
+#define HOST_BIGENDIAN 0
+
+/* Set the native cpu bit order (FILLORDER_LSB2MSB or FILLORDER_MSB2LSB) */
+#define HOST_FILLORDER FILLORDER_MSB2LSB
+
+/* Support JPEG compression (requires IJG JPEG library) */
+/* #undef JPEG_SUPPORT */
+
+/* Support LogLuv high dynamic range encoding */
+#define LOGLUV_SUPPORT 1
+
+/* Define to the sub-directory in which libtool stores uninstalled libraries.
+   */
+#define LT_OBJDIR ".libs/"
+
+/* Support LZW algorithm */
+#define LZW_SUPPORT 1
+
+/* Support Microsoft Document Imaging format */
+#define MDI_SUPPORT 1
+
+/* Support NeXT 2-bit RLE algorithm */
+#define NEXT_SUPPORT 1
+
+/* Define to 1 if your C compiler doesn't accept -c and -o together. */
+/* #undef NO_MINUS_C_MINUS_O */
+
+/* Support Old JPEG compresson (read contrib/ojpeg/README first! Compilation
+   fails with unpatched IJG JPEG library) */
+/* #undef OJPEG_SUPPORT */
+
+/* Name of package */
+#define PACKAGE "tiff"
+
+/* Define to the address where bug reports for this package should be sent. */
+#define PACKAGE_BUGREPORT "tiff@lists.maptools.org"
+
+/* Define to the full name of this package. */
+#define PACKAGE_NAME "LibTIFF Software"
+
+/* Define to the full name and version of this package. */
+#define PACKAGE_STRING "LibTIFF Software 3.8.2"
+
+/* Define to the one symbol short name of this package. */
+#define PACKAGE_TARNAME "tiff"
+
+/* Define to the version of this package. */
+#define PACKAGE_VERSION "3.8.2"
+
+/* Support Macintosh PackBits algorithm */
+#define PACKBITS_SUPPORT 1
+
+/* Support Pixar log-format algorithm (requires Zlib) */
+#define PIXARLOG_SUPPORT 1
+
+/* Define to necessary symbol if this constant uses a non-standard name on
+   your system. */
+/* #undef PTHREAD_CREATE_JOINABLE */
+
 /* The size of a `int', as computed by sizeof. */
 #define SIZEOF_INT 4
 
 /* The size of a `long', as computed by sizeof. */
 #define SIZEOF_LONG 4
 
-/* Set the native cpu bit order */
-#define HOST_FILLORDER FILLORDER_LSB2MSB
+/* Define to 1 if you have the ANSI C header files. */
+#define STDC_HEADERS 1
 
+/* Support strip chopping (whether or not to convert single-strip uncompressed
+   images to mutiple strips of specified size to reduce memory usage) */
+#define STRIPCHOP_DEFAULT TIFF_STRIPCHOP
+
+/* Default size of the strip in bytes (when strip chopping enabled) */
+#define STRIP_SIZE_DEFAULT 8192
+
+/* Enable SubIFD tag (330) support */
+#define SUBIFD_SUPPORT 1
+
+/* Support ThunderScan 4-bit RLE algorithm */
+#define THUNDER_SUPPORT 1
+
+/* Define to 1 if you can safely include both <sys/time.h> and <time.h>. */
+#define TIME_WITH_SYS_TIME 1
+
+/* Define to 1 if your <sys/time.h> declares `struct tm'. */
+/* #undef TM_IN_SYS_TIME */
+
+/* Version number of package */
+#define VERSION "3.8.2"
+
 /* Define to 1 if your processor stores words with the most significant byte
    first (like Motorola and SPARC, unlike Intel and VAX). */
 /* #undef WORDS_BIGENDIAN */
 
+/* Define to 1 if the X Window System is missing or not being used. */
+/* #undef X_DISPLAY_MISSING */
+
+/* Support Deflate compression */
+#define ZIP_SUPPORT 1
+
+/* Number of bits in a file offset, on hosts where this is settable. */
+#define _FILE_OFFSET_BITS 64
+
+/* Define for large files, on AIX-style hosts. */
+/* #undef _LARGE_FILES */
+
+/* Define to empty if `const' does not conform to ANSI C. */
+/* #undef const */
+
 /* Define to `__inline__' or `__inline' if that's what the C compiler
    calls it, or to nothing if 'inline' is not supported under any name.  */
 #ifndef __cplusplus
-# ifndef inline
-#  define inline __inline
-# endif
+/* #undef inline */
 #endif
 
-#if !defined (__BORLANDC__) && !defined (__WATCOMC__)
-   #define lfind _lfind
-#endif
+/* Define to `long' if <sys/types.h> does not define. */
+/* #undef off_t */
 
-#ifdef __DMC__
-#define HAVE_INT32
-typedef	long int32;
-#endif
-
-#ifdef _WIN32_WCE
-#   undef HAVE_FCNTL_H
-#   undef HAVE_SYS_TYPES_H
-
-    /*
-       CE headers don't define these standard constants (not even underscored
-       versions), provide our own replacements as they seem to be only used in
-       libtiff own code anyhow.
-     */
-#   define   O_RDONLY    0x0000
-#   define   O_WRONLY    0x0001
-#   define   O_RDWR      0x0002
-#   define   O_CREAT     0x0100
-#   define   O_TRUNC     0x0200
-#   define   O_EXCL      0x0400
-#endif /* _WIN32_WCE */
-
-#endif /* __APPLE__/!__APPLE__ */
+/* Define to `unsigned' if <sys/types.h> does not define. */
+/* #undef size_t */
Index: src/common/intl.cpp
===================================================================
--- src/common/intl.cpp	(revision 63626)
+++ src/common/intl.cpp	(working copy)
@@ -3102,6 +3102,7 @@
     // could try to reverse engineer the format from strftime() output but this
     // looks like too much trouble considering the relatively small number of
     // systems without nl_langinfo() still in use)
+    index=index;
     return wxString();
 #endif // HAVE_LANGINFO_H/!HAVE_LANGINFO_H
 }
Index: src/common/wxcrt.cpp
===================================================================
--- src/common/wxcrt.cpp	(revision 63626)
+++ src/common/wxcrt.cpp	(working copy)
@@ -16,6 +16,13 @@
 // For compilers that support precompilation, includes "wx.h".
 #include "wx/wxprec.h"
 
+#ifdef __QNX__
+// for vfwscanf()
+    #include <wchar.h>
+    #include <stdarg.h>
+    extern "C" int vswscanf(const wchar_t *, const wchar_t *, va_list);
+#endif
+
 #ifdef __BORLANDC__
     #pragma hdrstop
 #endif
Index: src/common/sckaddr.cpp
===================================================================
--- src/common/sckaddr.cpp	(revision 63626)
+++ src/common/sckaddr.cpp	(working copy)
@@ -317,7 +317,7 @@
     return he;
 }
 
-#if defined(HAVE_GETSERVBYNAME)
+#if defined(HAVE_GETSERVBYNAME) || defined __QNX__
 servent *deepCopyServent(servent *s,
                          servent *se,
                          char *buffer,
@@ -395,7 +395,7 @@
 #elif defined(HAVE_FUNC_GETSERVBYNAME_R_4)
     if ( getservbyname_r(port, protocol, serv, &buffer) != 0 )
         return NULL;
-#elif defined(HAVE_GETSERVBYNAME)
+#elif defined(HAVE_GETSERVBYNAME) || __QNX__
     wxLOCK_GETBY_MUTEX(serv);
 
     se = getservbyname(port, protocol);
Index: src/x11/evtloop.cpp
===================================================================
--- src/x11/evtloop.cpp	(revision 63626)
+++ src/x11/evtloop.cpp	(working copy)
@@ -171,7 +171,10 @@
 void wxGUIEventLoop::Exit(int rc)
 {
     wxCHECK_RET( IsRunning(), wxT("can't call Exit() if not running") );
-
+#ifdef __QNX__
+    // Necessary for QNX port for some reason: an exit event is sent before something is running
+    if (IsRunning()) return;
+#endif
     m_impl->SetExitCode(rc);
     m_impl->m_keepGoing = false;
 }
Index: src/generic/graphicc.cpp
===================================================================
--- src/generic/graphicc.cpp	(revision 63626)
+++ src/generic/graphicc.cpp	(working copy)
@@ -1963,4 +1963,11 @@
 #endif
 }
 
+#ifdef __QNX__
+wxGraphicsRenderer* wxGraphicsRenderer::GetDefaultRenderer()
+{
+    return NULL;
+}
+#endif
+
 #endif // wxUSE_GRAPHICS_CONTEXT
Index: include/wx/math.h
===================================================================
--- include/wx/math.h	(revision 63626)
+++ include/wx/math.h	(working copy)
@@ -18,6 +18,11 @@
 
 #include <math.h>
 
+#ifdef __QNX__
+    // Replacement for finite() which doesn't seem to exist in QNX 6.3.x
+    #define finite(value) (!isinf(value) && !isnan(value))
+#endif
+
 #ifndef M_PI
     #define M_PI 3.1415926535897932384626433832795
 #endif
Index: include/wx/string.h
===================================================================
--- include/wx/string.h	(revision 63626)
+++ include/wx/string.h	(working copy)
@@ -24,6 +24,10 @@
 
 #include "wx/defs.h"        // everybody should include this
 
+#ifdef __QNX__
+#include <strings.h>
+#endif
+
 #ifndef __WXPALMOS5__
 #if defined(__WXMAC__) || defined(__VISAGECPP__)
     #include <ctype.h>
Index: include/wx/private/selectdispatcher.h
===================================================================
--- include/wx/private/selectdispatcher.h	(revision 63626)
+++ include/wx/private/selectdispatcher.h	(working copy)
@@ -15,6 +15,10 @@
 
 #if wxUSE_SELECT_DISPATCHER
 
+#ifdef __QNX__
+  #include <sys/select.h>
+#endif
+
 #ifdef __WATCOMC__
   #include <types.h>
   #include <sys/ioctl.h>
Index: configure.in
===================================================================
--- configure.in	(revision 63626)
+++ configure.in	(working copy)
@@ -91,6 +91,7 @@
 USE_VMS=
 USE_ULTRIX=
 USE_UNIXWARE=
+USE_QNX=
 
 dnl hardware platform
 USE_ALPHA=
@@ -203,6 +204,11 @@
     AC_DEFINE(__BSD__)
     DEFAULT_DEFAULT_wxUSE_MOTIF=1
   ;;
+  *-*-sunos4* )
+    USE_QNX=1
+    AC_DEFINE(__QNX__)
+    DEFAULT_DEFAULT_wxUSE_X11=1
+  ;;
   *-*-freebsd*)
     USE_BSD=1
     USE_FREEBSD=1
@@ -4886,6 +4892,12 @@
                     THREAD_OPTS="-pthreads $THREAD_OPTS"
                 fi
                 ;;
+          *-*-qnx* )
+                if test "x$GCC" = "xyes"; then
+                    dnl Solaris/gcc combination use this one for some reason
+                    THREAD_OPTS="$THREAD_OPTS"
+                fi
+                ;;
           *-*-freebsd*)
                 dnl look, in order, for the kernel threads, then Linux threads
                 dnl and finally the userland threads
