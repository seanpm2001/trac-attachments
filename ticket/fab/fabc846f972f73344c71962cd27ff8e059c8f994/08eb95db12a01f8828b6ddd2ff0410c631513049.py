img = 'BM8\x04\x00\x00\x00\x00\x00\x006\x00\x00\x00(\x00\x00\x00\x10\x00\x00\x00\x10\x00\x00\x00\x01\x00 \x00\x00\x00\x00\x00\x02\x04\x00\x00\x12\x0b\x00\x00\x12\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x08\x08\x08\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x19\x19\x19\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xf7\xf7\xf7\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xf7\xf7\xf7\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xf7\xf7\xf7\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\xff\xff\xff\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00'

ImageMagick_info="""
Image: /var/lib/tomcat6/temp/imi32806.tmp
  Format: BMP (Microsoft Windows bitmap image)
  Class: DirectClass
  Geometry: 16x16+0+0
  Type: Palette
  Endianess: Undefined
  Colorspace: RGB
  Depth: 8-bit
  Channel depth:
    Red: 8-bit
    Green: 8-bit
    Blue: 8-bit
  Channel statistics:
    Red:
      Min: 0 (0)
      Max: 255 (1)
      Mean: 188.297 (0.738419)
      Standard deviation: 111.833 (0.438561)
    Green:
      Min: 0 (0)
      Max: 255 (1)
      Mean: 111.598 (0.437638)
      Standard deviation: 126.293 (0.495268)
    Blue:
      Min: 0 (0)
      Max: 255 (1)
      Mean: 188.297 (0.738419)
      Standard deviation: 111.833 (0.438561)
  Histogram:
       109: (255,255,255) #FFFFFF white
        77: (255,  0,255) #FF00FF magenta
        65: (  0,  0,  0) #000000 black
         3: (247,247,247) #F7F7F7 grey97
         1: (  8,  8,  8) #080808 grey3
         1: ( 25, 25, 25) #191919 rgb(25,25,25)
  Rendering intent: Undefined
  Resolution: 28.34x28.34
  Units: PixelsPerCentimeter
  Filesize: 1.05469kb
  Interlace: None
  Background color: white
  Border color: rgb(223,223,223)
  Matte color: grey74
  Transparent color: black
  Page geometry: 16x16+0+0
  Dispose: Undefined
  Iterations: 0
  Compression: Undefined
  Orientation: Undefined
  Signature: ee7323634ca3b6b2674448a2f557dcb7325a3f395522f660cba689ef8b3f96cd
  Tainted: False
  Version: ImageMagick 6.3.7 06/04/09 Q16 http://www.imagemagick.org
"""

import wx
from StringIO import StringIO
app = wx.PySimpleApp()
img = wx.ImageFromStream(StringIO(img))
print 'hasAlpha', img.HasAlpha()
if img.HasAlpha():
	if not any(map(ord, img.GetAlphaData())):
		print "Image is completely transparent"
assert any(map(ord, img.GetData())), "Image is black to begin with"
bmp = wx.BitmapFromImage(img)
bmp_image = bmp.ConvertToImage()
if not img.GetData() == bmp_image.GetData():
	print "Bitmap data doesn't match loaded image"

# If we disable transparency, the bitmap renders properly.
# It seems it's impossible to clear HasAlpha, so just set all
#  pixels to full opacity.
img.SetAlphaData('\xff'*(img.GetWidth() * img.GetHeight()))
bmp = wx.BitmapFromImage(img)
bmp_image = bmp.ConvertToImage()
if img.GetData() == bmp_image.GetData():
	print "Now the bitmap data does match"
