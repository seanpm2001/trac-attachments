--- wxWidgets.orig/include/wx/combo.h	Mon Sep 18 08:14:03 2006
+++ wxWidgets/include/wx/combo.h	Mon Sep 18 18:53:07 2006
@@ -200,4 +200,8 @@
     void SetText(const wxString& value);
 
+    // This method sets value and also optionally sends EVT_TEXT
+    // (needed by combo popups)
+    void SetValueWithEvent(const wxString& value, bool withEvent = true);
+
     //
     // Popup customization methods
@@ -522,4 +526,6 @@
 private:
     void Init();
+
+    wxByte                  m_ignoreEvtText;  // Number of next EVT_TEXTs to ignore
 
     DECLARE_EVENT_TABLE()
--- wxWidgets.orig/src/common/combocmn.cpp	Mon Sep 18 08:15:03 2006
+++ wxWidgets/src/common/combocmn.cpp	Mon Sep 18 18:53:07 2006
@@ -639,4 +639,5 @@
     m_btnWidDefault = 0;
     m_blankButtonBg = false;
+    m_ignoreEvtText = 0;
     m_btnWid = m_btnHei = -1;
     m_btnSide = wxRIGHT;
@@ -710,4 +711,12 @@
             style |= wxTE_PROCESS_ENTER;
 
+        // Ignore EVT_TEXT generated by the constructor (but only
+        // if the event redirector already exists)
+        // NB: This must be " = 1" instead of "++";
+        if ( m_textEvtHandler )
+            m_ignoreEvtText = 1;
+        else
+            m_ignoreEvtText = 0;
+
         m_text = new wxTextCtrl(this, wxID_ANY, m_valueString,
                                 wxDefaultPosition, wxDefaultSize,
@@ -1249,4 +1258,13 @@
 void wxComboCtrlBase::OnTextCtrlEvent(wxCommandEvent& event)
 {
+    if ( event.GetEventType() == wxEVT_COMMAND_TEXT_UPDATED )
+    {
+        if ( m_ignoreEvtText > 0 )
+        {
+            m_ignoreEvtText--;
+            return;
+        }
+    }
+
     // Change event id, object and string before relaying it forward
     event.SetId(GetId());
@@ -1925,8 +1943,11 @@
 }
 
-void wxComboCtrlBase::SetValue(const wxString& value)
+void wxComboCtrlBase::SetValueWithEvent(const wxString& value, bool withEvent)
 {
     if ( m_text )
     {
+        if ( !withEvent )
+            m_ignoreEvtText++;
+
         m_text->SetValue(value);
         if ( !(m_iFlags & wxCC_NO_TEXT_AUTO_SELECT) )
@@ -1946,4 +1967,9 @@
 }
 
+void wxComboCtrlBase::SetValue(const wxString& value)
+{
+    SetValueWithEvent(value, false);
+}
+
 // In this SetValue variant wxComboPopup::SetStringValue is not called
 void wxComboCtrlBase::SetText(const wxString& value)
@@ -1954,4 +1980,10 @@
 
     m_valueString = value;
+
+    if ( m_text )
+    {
+        m_ignoreEvtText++;
+        m_text->SetValue( value );
+    }
 
     Refresh();
--- wxWidgets.orig/src/generic/odcombo.cpp	Tue Sep  5 21:32:27 2006
+++ wxWidgets/src/generic/odcombo.cpp	Mon Sep 18 18:53:07 2006
@@ -202,5 +202,5 @@
 
     if ( valStr != m_combo->GetValue() )
-        m_combo->SetValue(valStr);
+        m_combo->SetValueWithEvent(valStr);
 
     SendComboBoxEvent(selection);

 	  	 
